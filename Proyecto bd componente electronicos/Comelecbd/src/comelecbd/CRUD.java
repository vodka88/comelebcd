/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package comelecbd;

import Ficheros.iofile;
import java.awt.List;

import tratamientostring.cadenas;
import java.io.BufferedReader;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.Statement;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.Iterator;
import java.util.LinkedList;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;
import controlbd.mani_bd;
import java.awt.Color;
import java.awt.event.ActionEvent;
import java.awt.event.KeyEvent;
import java.sql.SQLException;
import org.apache.commons.validator.UrlValidator;
import tablasvo.t_clase;
import tablasvo.t_datasheet;
import tablasvo.t_empaquetado;
import tablasvo.t_estados;
import tablasvo.t_principal;

/**
 *
 * @author HECTOR
 */
public class CRUD extends javax.swing.JFrame {
int cantidadColumnas ;
int cantidadFilas;

public ArrayList<String> list_TC_clase = new ArrayList();
public ArrayList<String> list_TC_tipo = new ArrayList(); 
public ArrayList<String> list_TC_subtipo = new ArrayList();


public ArrayList<String> list_T_tipo = new ArrayList(); 
public ArrayList<String> list_T_subtipo = new ArrayList();
public ArrayList<String> list_T_paquete = new ArrayList();
public ArrayList<String> list_T_estado = new ArrayList(); 





int capullos=0;
static Connection cn;
static Statement st;
static ResultSet rs;
boolean editable=false;
boolean editable_T=false;
boolean primera_lectura_T=false;


mani_bd control = new mani_bd();
    /**
     * Creates new form CRUD
     */
    public CRUD() {
        initComponents();
    }
public void conectar()
     {try
       {String url = new String ("jdbc:oracle:thin:@localhost:1525:probora");
        cn = DriverManager.getConnection(url,"system","naticris");
        st = cn.createStatement();}
      catch(Exception e )
       {JOptionPane.showMessageDialog(null,"No es posible conectarse a la base de datos \n"+e);}}   
    
    public void consulta(String tabla)
    { try 
      {conectar();
       rs=st.executeQuery("SELECT count(*) FROM "+tabla);
       if(rs.next())
        {cantidadFilas=rs.getInt("count(*)"); }  
       else{cantidadFilas=0;}
       
       rs=st.executeQuery("SELECT * FROM "+tabla);
       ResultSetMetaData rsMd = rs.getMetaData();
       cantidadColumnas = rsMd.getColumnCount();
       Object[] fila = new Object[cantidadColumnas];
       
       while(rs.next())
        {for(int i=1;i <= cantidadColumnas;i++)
          {fila[i-1]=rs.getObject(i);}
         /* t_clavepri.setText(fila[0].toString());
          clave_primaria= Integer.parseInt(t_clavepri.getText());
          t_nombre.setText(fila[1].toString());        
          t_apellido.setText(fila[2].toString());
          t_telefono.setText(fila[4].toString());
          t_direccion.setText(fila[3].toString());*/}
       rs.close();}
       catch(Exception e )
        {JOptionPane.showMessageDialog(null,"Error no se puede consultar a la base datos \n"+e);}}  
    
    
    public int cuenta_lineas_ficheros(String lee) throws FileNotFoundException, IOException
    {
        String cadena = new String();
         int contador =0;
         
          BufferedReader leer_fichero  = new BufferedReader(new FileReader(lee));
           cadena = leer_fichero.readLine();
           contador++;
         while (cadena !=null)
         {cadena = leer_fichero.readLine();
          contador++;}
         leer_fichero.close();
     return contador;
    
    }
    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        Panel_tablas = new javax.swing.JTabbedPane();
        CRUD_T_clase = new javax.swing.JPanel();
        Eti_TC_principal = new javax.swing.JLabel();
        b_TC_nuevoregistro = new javax.swing.JButton();
        Txt_TC_principal = new javax.swing.JTextField();
        Eti_TC_clase = new javax.swing.JLabel();
        Eti_TC_tipo = new javax.swing.JLabel();
        Eti_TC_subtipo = new javax.swing.JLabel();
        b_TC_principio = new javax.swing.JButton();
        b_TC_adelante = new javax.swing.JButton();
        b_TC_atras = new javax.swing.JButton();
        b_TC_final = new javax.swing.JButton();
        b_TC_alta = new javax.swing.JButton();
        b_TC_Baja = new javax.swing.JButton();
        b_TC_modificacion = new javax.swing.JButton();
        com_TC_clase = new javax.swing.JComboBox<>();
        com_TC_tipo = new javax.swing.JComboBox<>();
        com_TC_subtipo = new javax.swing.JComboBox<>();
        eti_TC_mensaje = new javax.swing.JLabel();
        b_TC_modificacion1 = new javax.swing.JButton();
        CRUD_T_estado = new javax.swing.JPanel();
        Eti_TE_principal = new javax.swing.JLabel();
        Txt_TE_principal = new javax.swing.JTextField();
        Eti_TE_estado = new javax.swing.JLabel();
        Txt_TE_estado = new javax.swing.JTextField();
        b_TE_principio = new javax.swing.JButton();
        b_TE_adelante = new javax.swing.JButton();
        b_TE_atras = new javax.swing.JButton();
        b_TE_final = new javax.swing.JButton();
        b_TP_confirmar1 = new javax.swing.JButton();
        b_TE_borrar = new javax.swing.JButton();
        b_TE_modificar = new javax.swing.JButton();
        b_TE_baja = new javax.swing.JButton();
        b_TE_alta = new javax.swing.JButton();
        eti_TE_mensaje = new javax.swing.JLabel();
        CRUD_T_datasheet = new javax.swing.JPanel();
        Eti_TD_principal = new javax.swing.JLabel();
        Txt_TD_principal = new javax.swing.JTextField();
        Eti_TD_url = new javax.swing.JLabel();
        Txt_TD_url = new javax.swing.JTextField();
        Eti_TD_descripcion = new javax.swing.JLabel();
        Txt_TD_descripcion = new javax.swing.JTextField();
        b_TD_principio = new javax.swing.JButton();
        b_TD_adelante = new javax.swing.JButton();
        b_TD_atras = new javax.swing.JButton();
        b_TD_final = new javax.swing.JButton();
        b_TD_alta = new javax.swing.JButton();
        b_TD_baja = new javax.swing.JButton();
        b_TD_modificar = new javax.swing.JButton();
        b_TD_borrar = new javax.swing.JButton();
        b_TD_nuevoregistro = new javax.swing.JButton();
        Txt_TD_Datasheet = new javax.swing.JTextField();
        Eti_TD_encapsulado3 = new javax.swing.JLabel();
        b_TD_buscar = new javax.swing.JButton();
        eti_TD_mensaje = new javax.swing.JLabel();
        CRUD_T_principal = new javax.swing.JPanel();
        Eti_T_principal = new javax.swing.JLabel();
        Eti_T_componente = new javax.swing.JLabel();
        Eti_T_tipo = new javax.swing.JLabel();
        Eti_T_subtipo = new javax.swing.JLabel();
        Eti_T_pines = new javax.swing.JLabel();
        Eti_T_datasheet = new javax.swing.JLabel();
        Eti_T_url = new javax.swing.JLabel();
        Txt_T_principal = new javax.swing.JTextField();
        Txt_T_url = new javax.swing.JTextField();
        com_T_tipo = new javax.swing.JComboBox<>();
        com_T_subtipo = new javax.swing.JComboBox<>();
        Eti_T_estado = new javax.swing.JLabel();
        com_T_estado = new javax.swing.JComboBox<>();
        Eti_T_estado1 = new javax.swing.JLabel();
        Txt_T_pines = new javax.swing.JTextField();
        b_T_principio = new javax.swing.JButton();
        b_T_adelante = new javax.swing.JButton();
        b_T_atras = new javax.swing.JButton();
        b_T_final = new javax.swing.JButton();
        b_T_alta = new javax.swing.JButton();
        b_T_Baja = new javax.swing.JButton();
        b_T_modificacion = new javax.swing.JButton();
        b_T_nuevoregistro = new javax.swing.JButton();
        com_T_paquete = new javax.swing.JComboBox<>();
        Eti_T_paquete1 = new javax.swing.JLabel();
        Txt_T_cantidad = new javax.swing.JTextField();
        b_T_buscar = new javax.swing.JButton();
        b_T_modificacion2 = new javax.swing.JButton();
        eti_TC_mensaje1 = new javax.swing.JLabel();
        eti_T_mensaje = new javax.swing.JLabel();
        Txt_T_componente = new javax.swing.JTextField();
        Txt_T_datasheet = new javax.swing.JTextField();
        CRUD_T_empaquetado = new javax.swing.JPanel();
        Eti_TP_descripcion = new javax.swing.JLabel();
        Eti_TP_principal1 = new javax.swing.JLabel();
        Eti_TP_npatillas1 = new javax.swing.JLabel();
        Txt_TP_principal = new javax.swing.JTextField();
        Txt_TP_url = new javax.swing.JTextField();
        Txt_TP_npatillas1 = new javax.swing.JTextField();
        b_TP_principio = new javax.swing.JButton();
        b_TP_adelante = new javax.swing.JButton();
        b_TP_atras = new javax.swing.JButton();
        b_TP_final = new javax.swing.JButton();
        b_TP_alta = new javax.swing.JButton();
        b_TP_baja = new javax.swing.JButton();
        b_TP_modificar = new javax.swing.JButton();
        b_TP_borrar = new javax.swing.JButton();
        b_TP_nuevoregistro = new javax.swing.JButton();
        Eti_TP_encapsulado2 = new javax.swing.JLabel();
        Txt_TP_encapsulado1 = new javax.swing.JTextField();
        Eti_TP_descripcion1 = new javax.swing.JLabel();
        Txt_TP_descripcion1 = new javax.swing.JTextField();
        eti_TP_mensaje = new javax.swing.JLabel();
        jPanel2 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        txt_directorio = new javax.swing.JTextField();
        jLabel2 = new javax.swing.JLabel();
        txt_tabla = new javax.swing.JTextField();
        jButton1 = new javax.swing.JButton();
        b_llenartabla = new javax.swing.JButton();
        jButton2 = new javax.swing.JButton();
        b_llenartabla1 = new javax.swing.JButton();
        MenuCRUD = new javax.swing.JMenuBar();
        jMenu1 = new javax.swing.JMenu();
        jMenu2 = new javax.swing.JMenu();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        Panel_tablas.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                Panel_tablasMouseClicked(evt);
            }
            public void mouseEntered(java.awt.event.MouseEvent evt) {
                Panel_tablasMouseEntered(evt);
            }
        });

        Eti_TC_principal.setText("Clave");

        b_TC_nuevoregistro.setText("Nuevo registro");
        b_TC_nuevoregistro.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TC_nuevoregistroActionPerformed(evt);
            }
        });

        Txt_TC_principal.setEditable(false);
        Txt_TC_principal.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Txt_TC_principalActionPerformed(evt);
            }
        });

        Eti_TC_clase.setText("Clase");

        Eti_TC_tipo.setText("Tipo");

        Eti_TC_subtipo.setText("Subtipo");

        b_TC_principio.setText("Principio");
        b_TC_principio.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TC_principioActionPerformed(evt);
            }
        });

        b_TC_adelante.setText("Adelante");
        b_TC_adelante.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TC_adelanteActionPerformed(evt);
            }
        });

        b_TC_atras.setText("Atras");
        b_TC_atras.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TC_atrasActionPerformed(evt);
            }
        });

        b_TC_final.setText("Final");
        b_TC_final.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TC_finalActionPerformed(evt);
            }
        });

        b_TC_alta.setText("Alta");
        b_TC_alta.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TC_altaActionPerformed(evt);
            }
        });

        b_TC_Baja.setText("Baja");
        b_TC_Baja.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TC_BajaActionPerformed(evt);
            }
        });

        b_TC_modificacion.setText("Modificar");
        b_TC_modificacion.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TC_modificacionActionPerformed(evt);
            }
        });

        com_TC_clase.setEditable(true);
        com_TC_clase.setMaximumRowCount(10);
        com_TC_clase.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "4" }));
        com_TC_clase.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                com_TC_claseActionPerformed(evt);
            }
        });

        com_TC_tipo.setEditable(true);
        com_TC_tipo.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "4" }));
        com_TC_tipo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                com_TC_tipoActionPerformed(evt);
            }
        });

        com_TC_subtipo.setEditable(true);
        com_TC_subtipo.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "4" }));
        com_TC_subtipo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                com_TC_subtipoActionPerformed(evt);
            }
        });

        b_TC_modificacion1.setText("Modificar campos");
        b_TC_modificacion1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TC_modificacion1ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout CRUD_T_claseLayout = new javax.swing.GroupLayout(CRUD_T_clase);
        CRUD_T_clase.setLayout(CRUD_T_claseLayout);
        CRUD_T_claseLayout.setHorizontalGroup(
            CRUD_T_claseLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(CRUD_T_claseLayout.createSequentialGroup()
                .addGap(82, 82, 82)
                .addComponent(eti_TC_mensaje, javax.swing.GroupLayout.PREFERRED_SIZE, 350, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(201, Short.MAX_VALUE))
            .addGroup(CRUD_T_claseLayout.createSequentialGroup()
                .addGroup(CRUD_T_claseLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, CRUD_T_claseLayout.createSequentialGroup()
                        .addGap(28, 28, 28)
                        .addGroup(CRUD_T_claseLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(CRUD_T_claseLayout.createSequentialGroup()
                                .addComponent(Eti_TC_principal, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(Txt_TC_principal, javax.swing.GroupLayout.PREFERRED_SIZE, 102, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(CRUD_T_claseLayout.createSequentialGroup()
                                .addComponent(Eti_TC_clase)
                                .addGap(0, 0, Short.MAX_VALUE))))
                    .addGroup(CRUD_T_claseLayout.createSequentialGroup()
                        .addGap(27, 27, 27)
                        .addGroup(CRUD_T_claseLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, CRUD_T_claseLayout.createSequentialGroup()
                                .addComponent(Eti_TC_tipo, javax.swing.GroupLayout.PREFERRED_SIZE, 61, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED))
                            .addGroup(CRUD_T_claseLayout.createSequentialGroup()
                                .addComponent(Eti_TC_subtipo)
                                .addGap(35, 35, 35)))
                        .addGroup(CRUD_T_claseLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(com_TC_subtipo, javax.swing.GroupLayout.PREFERRED_SIZE, 102, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(com_TC_tipo, javax.swing.GroupLayout.PREFERRED_SIZE, 102, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(com_TC_clase, javax.swing.GroupLayout.PREFERRED_SIZE, 113, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(b_TC_modificacion1)
                .addGap(57, 57, 57))
            .addGroup(CRUD_T_claseLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(CRUD_T_claseLayout.createSequentialGroup()
                    .addGap(0, 0, Short.MAX_VALUE)
                    .addComponent(b_TC_principio)
                    .addGap(8, 8, 8)
                    .addComponent(b_TC_adelante)
                    .addGap(8, 8, 8)
                    .addComponent(b_TC_atras)
                    .addGap(9, 9, 9)
                    .addComponent(b_TC_final)
                    .addGap(25, 25, 25)
                    .addComponent(b_TC_alta)
                    .addGap(9, 9, 9)
                    .addComponent(b_TC_Baja)
                    .addGap(7, 7, 7)
                    .addComponent(b_TC_modificacion)
                    .addGap(15, 15, 15)
                    .addComponent(b_TC_nuevoregistro)
                    .addGap(0, 0, Short.MAX_VALUE)))
        );
        CRUD_T_claseLayout.setVerticalGroup(
            CRUD_T_claseLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(CRUD_T_claseLayout.createSequentialGroup()
                .addGroup(CRUD_T_claseLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(CRUD_T_claseLayout.createSequentialGroup()
                        .addGap(15, 15, 15)
                        .addGroup(CRUD_T_claseLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(Eti_TC_principal, javax.swing.GroupLayout.PREFERRED_SIZE, 23, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(Txt_TC_principal, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(CRUD_T_claseLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(Eti_TC_clase, javax.swing.GroupLayout.PREFERRED_SIZE, 23, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(com_TC_clase, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(CRUD_T_claseLayout.createSequentialGroup()
                        .addGap(24, 24, 24)
                        .addComponent(b_TC_modificacion1)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(CRUD_T_claseLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(Eti_TC_tipo, javax.swing.GroupLayout.PREFERRED_SIZE, 23, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(com_TC_tipo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(CRUD_T_claseLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(Eti_TC_subtipo, javax.swing.GroupLayout.PREFERRED_SIZE, 23, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(com_TC_subtipo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(41, 41, 41)
                .addComponent(eti_TC_mensaje, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(348, Short.MAX_VALUE))
            .addGroup(CRUD_T_claseLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(CRUD_T_claseLayout.createSequentialGroup()
                    .addContainerGap(426, Short.MAX_VALUE)
                    .addGroup(CRUD_T_claseLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(b_TC_principio)
                        .addComponent(b_TC_adelante)
                        .addComponent(b_TC_atras)
                        .addComponent(b_TC_final)
                        .addComponent(b_TC_alta)
                        .addComponent(b_TC_Baja)
                        .addComponent(b_TC_modificacion)
                        .addComponent(b_TC_nuevoregistro))
                    .addGap(0, 170, Short.MAX_VALUE)))
        );

        Panel_tablas.addTab("Tabla clase", CRUD_T_clase);

        CRUD_T_estado.setLayout(null);

        Eti_TE_principal.setText("Clave");
        CRUD_T_estado.add(Eti_TE_principal);
        Eti_TE_principal.setBounds(10, 10, 27, 14);

        Txt_TE_principal.setEditable(false);
        Txt_TE_principal.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Txt_TE_principalActionPerformed(evt);
            }
        });
        CRUD_T_estado.add(Txt_TE_principal);
        Txt_TE_principal.setBounds(90, 10, 100, 20);

        Eti_TE_estado.setText("Estado");
        CRUD_T_estado.add(Eti_TE_estado);
        Eti_TE_estado.setBounds(10, 40, 60, 14);

        Txt_TE_estado.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Txt_TE_estadoActionPerformed(evt);
            }
        });
        Txt_TE_estado.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                Txt_TE_estadoKeyPressed(evt);
            }
        });
        CRUD_T_estado.add(Txt_TE_estado);
        Txt_TE_estado.setBounds(90, 40, 100, 20);

        b_TE_principio.setText("Principio");
        b_TE_principio.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TE_principioActionPerformed(evt);
            }
        });
        CRUD_T_estado.add(b_TE_principio);
        b_TE_principio.setBounds(10, 180, 71, 23);

        b_TE_adelante.setText("Adelante");
        b_TE_adelante.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TE_adelanteActionPerformed(evt);
            }
        });
        CRUD_T_estado.add(b_TE_adelante);
        b_TE_adelante.setBounds(90, 180, 80, 23);

        b_TE_atras.setText("Atras");
        b_TE_atras.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TE_atrasActionPerformed(evt);
            }
        });
        CRUD_T_estado.add(b_TE_atras);
        b_TE_atras.setBounds(180, 180, 59, 23);

        b_TE_final.setText("Final");
        b_TE_final.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TE_finalActionPerformed(evt);
            }
        });
        CRUD_T_estado.add(b_TE_final);
        b_TE_final.setBounds(260, 180, 55, 23);

        b_TP_confirmar1.setText("Nueva registro");
        b_TP_confirmar1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TP_confirmar1ActionPerformed(evt);
            }
        });
        CRUD_T_estado.add(b_TP_confirmar1);
        b_TP_confirmar1.setBounds(330, 200, 90, 23);

        b_TE_borrar.setText("Borrat");
        CRUD_T_estado.add(b_TE_borrar);
        b_TE_borrar.setBounds(260, 220, 63, 23);

        b_TE_modificar.setText("Modificar");
        b_TE_modificar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TE_modificarActionPerformed(evt);
            }
        });
        CRUD_T_estado.add(b_TE_modificar);
        b_TE_modificar.setBounds(170, 220, 75, 23);

        b_TE_baja.setText("Baja");
        b_TE_baja.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TE_bajaActionPerformed(evt);
            }
        });
        CRUD_T_estado.add(b_TE_baja);
        b_TE_baja.setBounds(90, 220, 53, 23);

        b_TE_alta.setText("Alta");
        b_TE_alta.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TE_altaActionPerformed(evt);
            }
        });
        CRUD_T_estado.add(b_TE_alta);
        b_TE_alta.setBounds(10, 220, 51, 23);
        CRUD_T_estado.add(eti_TE_mensaje);
        eti_TE_mensaje.setBounds(60, 280, 350, 100);

        Panel_tablas.addTab("Tabla estados", CRUD_T_estado);

        CRUD_T_datasheet.setLayout(null);

        Eti_TD_principal.setText("Clave");
        CRUD_T_datasheet.add(Eti_TD_principal);
        Eti_TD_principal.setBounds(10, 10, 27, 14);

        Txt_TD_principal.setEditable(false);
        Txt_TD_principal.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Txt_TD_principalActionPerformed(evt);
            }
        });
        CRUD_T_datasheet.add(Txt_TD_principal);
        Txt_TD_principal.setBounds(90, 10, 100, 20);

        Eti_TD_url.setText("URL");
        CRUD_T_datasheet.add(Eti_TD_url);
        Eti_TD_url.setBounds(10, 40, 80, 14);

        Txt_TD_url.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Txt_TD_urlActionPerformed(evt);
            }
        });
        Txt_TD_url.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                Txt_TD_urlKeyPressed(evt);
            }
        });
        CRUD_T_datasheet.add(Txt_TD_url);
        Txt_TD_url.setBounds(90, 40, 100, 20);

        Eti_TD_descripcion.setText("Descripcion");
        CRUD_T_datasheet.add(Eti_TD_descripcion);
        Eti_TD_descripcion.setBounds(10, 100, 80, 14);

        Txt_TD_descripcion.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Txt_TD_descripcionActionPerformed(evt);
            }
        });
        Txt_TD_descripcion.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                Txt_TD_descripcionKeyPressed(evt);
            }
        });
        CRUD_T_datasheet.add(Txt_TD_descripcion);
        Txt_TD_descripcion.setBounds(90, 100, 100, 20);

        b_TD_principio.setText("Principio");
        b_TD_principio.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TD_principioActionPerformed(evt);
            }
        });
        CRUD_T_datasheet.add(b_TD_principio);
        b_TD_principio.setBounds(10, 180, 71, 23);

        b_TD_adelante.setText("Adelante");
        b_TD_adelante.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TD_adelanteActionPerformed(evt);
            }
        });
        CRUD_T_datasheet.add(b_TD_adelante);
        b_TD_adelante.setBounds(90, 180, 80, 23);

        b_TD_atras.setText("Atras");
        b_TD_atras.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TD_atrasActionPerformed(evt);
            }
        });
        CRUD_T_datasheet.add(b_TD_atras);
        b_TD_atras.setBounds(180, 180, 59, 23);

        b_TD_final.setText("Final");
        b_TD_final.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TD_finalActionPerformed(evt);
            }
        });
        CRUD_T_datasheet.add(b_TD_final);
        b_TD_final.setBounds(260, 180, 55, 23);

        b_TD_alta.setText("Alta");
        b_TD_alta.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TD_altaActionPerformed(evt);
            }
        });
        CRUD_T_datasheet.add(b_TD_alta);
        b_TD_alta.setBounds(10, 220, 51, 23);

        b_TD_baja.setText("Baja");
        b_TD_baja.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TD_bajaActionPerformed(evt);
            }
        });
        CRUD_T_datasheet.add(b_TD_baja);
        b_TD_baja.setBounds(90, 220, 53, 23);

        b_TD_modificar.setText("Modificar");
        b_TD_modificar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TD_modificarActionPerformed(evt);
            }
        });
        CRUD_T_datasheet.add(b_TD_modificar);
        b_TD_modificar.setBounds(170, 220, 75, 23);

        b_TD_borrar.setText("Borrat");
        b_TD_borrar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TD_borrarActionPerformed(evt);
            }
        });
        CRUD_T_datasheet.add(b_TD_borrar);
        b_TD_borrar.setBounds(260, 220, 63, 23);

        b_TD_nuevoregistro.setText("Nuevo registro");
        b_TD_nuevoregistro.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TD_nuevoregistroActionPerformed(evt);
            }
        });
        CRUD_T_datasheet.add(b_TD_nuevoregistro);
        b_TD_nuevoregistro.setBounds(330, 200, 90, 23);

        Txt_TD_Datasheet.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Txt_TD_DatasheetActionPerformed(evt);
            }
        });
        Txt_TD_Datasheet.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                Txt_TD_DatasheetKeyPressed(evt);
            }
        });
        CRUD_T_datasheet.add(Txt_TD_Datasheet);
        Txt_TD_Datasheet.setBounds(90, 70, 100, 20);

        Eti_TD_encapsulado3.setText("Datasheet");
        CRUD_T_datasheet.add(Eti_TD_encapsulado3);
        Eti_TD_encapsulado3.setBounds(10, 70, 80, 20);

        b_TD_buscar.setText("Buscar");
        b_TD_buscar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TD_buscarActionPerformed(evt);
            }
        });
        CRUD_T_datasheet.add(b_TD_buscar);
        b_TD_buscar.setBounds(210, 70, 65, 23);
        CRUD_T_datasheet.add(eti_TD_mensaje);
        eti_TD_mensaje.setBounds(60, 280, 350, 100);

        Panel_tablas.addTab("Tabla Datasheet", CRUD_T_datasheet);

        CRUD_T_principal.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        Eti_T_principal.setText("Clave");
        CRUD_T_principal.add(Eti_T_principal, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 10, 35, 23));

        Eti_T_componente.setText("Componente");
        CRUD_T_principal.add(Eti_T_componente, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 40, -1, 23));

        Eti_T_tipo.setText("Tipo");
        CRUD_T_principal.add(Eti_T_tipo, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 69, 61, 23));

        Eti_T_subtipo.setText("Subtipo");
        CRUD_T_principal.add(Eti_T_subtipo, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 98, -1, 23));

        Eti_T_pines.setText("Pines");
        CRUD_T_principal.add(Eti_T_pines, new org.netbeans.lib.awtextra.AbsoluteConstraints(280, 100, -1, 23));

        Eti_T_datasheet.setText("Datasheet");
        CRUD_T_principal.add(Eti_T_datasheet, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 150, -1, 23));

        Eti_T_url.setText("URL");
        CRUD_T_principal.add(Eti_T_url, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 185, 50, 23));

        Txt_T_principal.setEditable(false);
        Txt_T_principal.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Txt_T_principalActionPerformed(evt);
            }
        });
        CRUD_T_principal.add(Txt_T_principal, new org.netbeans.lib.awtextra.AbsoluteConstraints(82, 12, 102, -1));

        Txt_T_url.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Txt_T_urlActionPerformed(evt);
            }
        });
        Txt_T_url.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                Txt_T_urlKeyPressed(evt);
            }
        });
        CRUD_T_principal.add(Txt_T_url, new org.netbeans.lib.awtextra.AbsoluteConstraints(80, 190, 102, -1));

        com_T_tipo.setEditable(true);
        com_T_tipo.setMaximumRowCount(10);
        com_T_tipo.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "" }));
        com_T_tipo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                com_T_tipoActionPerformed(evt);
            }
        });
        CRUD_T_principal.add(com_T_tipo, new org.netbeans.lib.awtextra.AbsoluteConstraints(81, 70, 102, -1));

        com_T_subtipo.setEditable(true);
        com_T_subtipo.setMaximumRowCount(10);
        com_T_subtipo.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "" }));
        com_T_subtipo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                com_T_subtipoActionPerformed(evt);
            }
        });
        CRUD_T_principal.add(com_T_subtipo, new org.netbeans.lib.awtextra.AbsoluteConstraints(81, 99, 102, -1));

        Eti_T_estado.setText("Estado");
        CRUD_T_principal.add(Eti_T_estado, new org.netbeans.lib.awtextra.AbsoluteConstraints(276, 11, 41, 23));

        com_T_estado.setMaximumRowCount(10);
        com_T_estado.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "" }));
        com_T_estado.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                com_T_estadoActionPerformed(evt);
            }
        });
        CRUD_T_principal.add(com_T_estado, new org.netbeans.lib.awtextra.AbsoluteConstraints(340, 10, 56, -1));

        Eti_T_estado1.setText("Cantidad");
        CRUD_T_principal.add(Eti_T_estado1, new org.netbeans.lib.awtextra.AbsoluteConstraints(276, 40, 54, 23));

        Txt_T_pines.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Txt_T_pinesActionPerformed(evt);
            }
        });
        Txt_T_pines.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                Txt_T_pinesKeyPressed(evt);
            }
        });
        CRUD_T_principal.add(Txt_T_pines, new org.netbeans.lib.awtextra.AbsoluteConstraints(330, 100, 43, -1));

        b_T_principio.setText("Principio");
        b_T_principio.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_T_principioActionPerformed(evt);
            }
        });
        CRUD_T_principal.add(b_T_principio, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 240, -1, -1));

        b_T_adelante.setText("Adelante");
        b_T_adelante.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_T_adelanteActionPerformed(evt);
            }
        });
        CRUD_T_principal.add(b_T_adelante, new org.netbeans.lib.awtextra.AbsoluteConstraints(79, 240, -1, -1));

        b_T_atras.setText("Atras");
        b_T_atras.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_T_atrasActionPerformed(evt);
            }
        });
        CRUD_T_principal.add(b_T_atras, new org.netbeans.lib.awtextra.AbsoluteConstraints(162, 240, -1, -1));

        b_T_final.setText("Final");
        b_T_final.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_T_finalActionPerformed(evt);
            }
        });
        CRUD_T_principal.add(b_T_final, new org.netbeans.lib.awtextra.AbsoluteConstraints(230, 240, -1, -1));

        b_T_alta.setText("Alta");
        b_T_alta.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_T_altaActionPerformed(evt);
            }
        });
        CRUD_T_principal.add(b_T_alta, new org.netbeans.lib.awtextra.AbsoluteConstraints(310, 240, -1, -1));

        b_T_Baja.setText("Baja");
        b_T_Baja.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_T_BajaActionPerformed(evt);
            }
        });
        CRUD_T_principal.add(b_T_Baja, new org.netbeans.lib.awtextra.AbsoluteConstraints(370, 240, -1, -1));

        b_T_modificacion.setText("Modificar");
        b_T_modificacion.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_T_modificacionActionPerformed(evt);
            }
        });
        CRUD_T_principal.add(b_T_modificacion, new org.netbeans.lib.awtextra.AbsoluteConstraints(430, 240, -1, -1));

        b_T_nuevoregistro.setText("Nuevo registro");
        b_T_nuevoregistro.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_T_nuevoregistroActionPerformed(evt);
            }
        });
        CRUD_T_principal.add(b_T_nuevoregistro, new org.netbeans.lib.awtextra.AbsoluteConstraints(520, 240, -1, -1));

        com_T_paquete.setEditable(true);
        com_T_paquete.setMaximumRowCount(10);
        com_T_paquete.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "1" }));
        com_T_paquete.setToolTipText("");
        com_T_paquete.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                com_T_paqueteActionPerformed(evt);
            }
        });
        CRUD_T_principal.add(com_T_paquete, new org.netbeans.lib.awtextra.AbsoluteConstraints(330, 70, 102, -1));

        Eti_T_paquete1.setText("Paquete");
        CRUD_T_principal.add(Eti_T_paquete1, new org.netbeans.lib.awtextra.AbsoluteConstraints(280, 70, -1, 23));

        Txt_T_cantidad.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Txt_T_cantidadActionPerformed(evt);
            }
        });
        Txt_T_cantidad.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                Txt_T_cantidadKeyPressed(evt);
            }
        });
        CRUD_T_principal.add(Txt_T_cantidad, new org.netbeans.lib.awtextra.AbsoluteConstraints(340, 40, 43, -1));

        b_T_buscar.setText("Buscar");
        b_T_buscar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_T_buscarActionPerformed(evt);
            }
        });
        CRUD_T_principal.add(b_T_buscar, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 150, -1, -1));

        b_T_modificacion2.setText("Modificar campos");
        b_T_modificacion2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_T_modificacion2ActionPerformed(evt);
            }
        });
        CRUD_T_principal.add(b_T_modificacion2, new org.netbeans.lib.awtextra.AbsoluteConstraints(450, 180, -1, -1));
        CRUD_T_principal.add(eti_TC_mensaje1, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 40, 20));
        CRUD_T_principal.add(eti_T_mensaje, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 320, 310, 130));

        Txt_T_componente.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Txt_T_componenteActionPerformed(evt);
            }
        });
        Txt_T_componente.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                Txt_T_componenteKeyPressed(evt);
            }
        });
        CRUD_T_principal.add(Txt_T_componente, new org.netbeans.lib.awtextra.AbsoluteConstraints(81, 41, 102, -1));

        Txt_T_datasheet.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Txt_T_datasheetActionPerformed(evt);
            }
        });
        Txt_T_datasheet.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                Txt_T_datasheetKeyPressed(evt);
            }
        });
        CRUD_T_principal.add(Txt_T_datasheet, new org.netbeans.lib.awtextra.AbsoluteConstraints(80, 150, 102, -1));

        Panel_tablas.addTab("Tabla Principal", CRUD_T_principal);

        CRUD_T_empaquetado.setLayout(null);

        Eti_TP_descripcion.setText("URL");
        CRUD_T_empaquetado.add(Eti_TP_descripcion);
        Eti_TP_descripcion.setBounds(240, 50, 80, 14);

        Eti_TP_principal1.setText("Clave");
        CRUD_T_empaquetado.add(Eti_TP_principal1);
        Eti_TP_principal1.setBounds(10, 10, 27, 14);

        Eti_TP_npatillas1.setText("Numero patilllas");
        CRUD_T_empaquetado.add(Eti_TP_npatillas1);
        Eti_TP_npatillas1.setBounds(10, 40, 80, 14);

        Txt_TP_principal.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Txt_TP_principalActionPerformed(evt);
            }
        });
        CRUD_T_empaquetado.add(Txt_TP_principal);
        Txt_TP_principal.setBounds(90, 10, 100, 20);

        Txt_TP_url.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Txt_TP_urlActionPerformed(evt);
            }
        });
        Txt_TP_url.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                Txt_TP_urlKeyPressed(evt);
            }
        });
        CRUD_T_empaquetado.add(Txt_TP_url);
        Txt_TP_url.setBounds(320, 50, 100, 20);

        Txt_TP_npatillas1.setHighlighter(null);
        Txt_TP_npatillas1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Txt_TP_npatillas1ActionPerformed(evt);
            }
        });
        Txt_TP_npatillas1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                Txt_TP_npatillas1KeyPressed(evt);
            }
            public void keyReleased(java.awt.event.KeyEvent evt) {
                Txt_TP_npatillas1KeyReleased(evt);
            }
        });
        CRUD_T_empaquetado.add(Txt_TP_npatillas1);
        Txt_TP_npatillas1.setBounds(90, 40, 100, 20);

        b_TP_principio.setText("Principio");
        b_TP_principio.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TP_principioActionPerformed(evt);
            }
        });
        CRUD_T_empaquetado.add(b_TP_principio);
        b_TP_principio.setBounds(10, 180, 71, 23);

        b_TP_adelante.setText("Adelante");
        b_TP_adelante.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TP_adelanteActionPerformed(evt);
            }
        });
        CRUD_T_empaquetado.add(b_TP_adelante);
        b_TP_adelante.setBounds(90, 180, 80, 23);

        b_TP_atras.setText("Atras");
        b_TP_atras.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TP_atrasActionPerformed(evt);
            }
        });
        CRUD_T_empaquetado.add(b_TP_atras);
        b_TP_atras.setBounds(180, 180, 59, 23);

        b_TP_final.setText("Final");
        b_TP_final.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TP_finalActionPerformed(evt);
            }
        });
        CRUD_T_empaquetado.add(b_TP_final);
        b_TP_final.setBounds(260, 180, 55, 23);

        b_TP_alta.setText("Alta");
        b_TP_alta.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TP_altaActionPerformed(evt);
            }
        });
        CRUD_T_empaquetado.add(b_TP_alta);
        b_TP_alta.setBounds(10, 220, 51, 23);

        b_TP_baja.setText("Baja");
        b_TP_baja.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TP_bajaActionPerformed(evt);
            }
        });
        CRUD_T_empaquetado.add(b_TP_baja);
        b_TP_baja.setBounds(90, 220, 53, 23);

        b_TP_modificar.setText("Modificar");
        b_TP_modificar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TP_modificarActionPerformed(evt);
            }
        });
        CRUD_T_empaquetado.add(b_TP_modificar);
        b_TP_modificar.setBounds(170, 220, 75, 23);

        b_TP_borrar.setText("Borrat");
        CRUD_T_empaquetado.add(b_TP_borrar);
        b_TP_borrar.setBounds(260, 220, 63, 23);

        b_TP_nuevoregistro.setText("Nuevo registro");
        b_TP_nuevoregistro.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_TP_nuevoregistroActionPerformed(evt);
            }
        });
        CRUD_T_empaquetado.add(b_TP_nuevoregistro);
        b_TP_nuevoregistro.setBounds(330, 200, 110, 23);

        Eti_TP_encapsulado2.setText("Encapsulados");
        CRUD_T_empaquetado.add(Eti_TP_encapsulado2);
        Eti_TP_encapsulado2.setBounds(10, 70, 80, 14);

        Txt_TP_encapsulado1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Txt_TP_encapsulado1ActionPerformed(evt);
            }
        });
        Txt_TP_encapsulado1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                Txt_TP_encapsulado1KeyPressed(evt);
            }
        });
        CRUD_T_empaquetado.add(Txt_TP_encapsulado1);
        Txt_TP_encapsulado1.setBounds(90, 70, 100, 20);

        Eti_TP_descripcion1.setText("Descripcion");
        CRUD_T_empaquetado.add(Eti_TP_descripcion1);
        Eti_TP_descripcion1.setBounds(240, 20, 80, 14);

        Txt_TP_descripcion1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Txt_TP_descripcion1ActionPerformed(evt);
            }
        });
        Txt_TP_descripcion1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                Txt_TP_descripcion1KeyPressed(evt);
            }
        });
        CRUD_T_empaquetado.add(Txt_TP_descripcion1);
        Txt_TP_descripcion1.setBounds(320, 20, 100, 20);
        CRUD_T_empaquetado.add(eti_TP_mensaje);
        eti_TP_mensaje.setBounds(60, 280, 350, 100);

        Panel_tablas.addTab("Tabla empaquetado", CRUD_T_empaquetado);

        jLabel1.setText("Direcctorio");

        jLabel2.setText("Tabla");

        jButton1.setText("Abrir carpeta");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        b_llenartabla.setText("llenar tabla");
        b_llenartabla.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_llenartablaActionPerformed(evt);
            }
        });

        jButton2.setText("borrar");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });

        b_llenartabla1.setText("llenar tabla datasheest");
        b_llenartabla1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                b_llenartabla1ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGap(24, 24, 24)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 57, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(txt_directorio, javax.swing.GroupLayout.PREFERRED_SIZE, 124, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, 57, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(txt_tabla, javax.swing.GroupLayout.PREFERRED_SIZE, 124, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(57, 57, 57)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jButton2)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(b_llenartabla)
                        .addGap(41, 41, 41)
                        .addComponent(b_llenartabla1))
                    .addComponent(jButton1))
                .addContainerGap(84, Short.MAX_VALUE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGap(27, 27, 27)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txt_directorio, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jButton1))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(txt_tabla, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(b_llenartabla)
                        .addComponent(b_llenartabla1)))
                .addGap(23, 23, 23)
                .addComponent(jButton2)
                .addContainerGap(478, Short.MAX_VALUE))
        );

        Panel_tablas.addTab("improvisado", jPanel2);

        MenuCRUD.setToolTipText("");

        jMenu1.setText("File");
        MenuCRUD.add(jMenu1);

        jMenu2.setText("Edit");
        MenuCRUD.add(jMenu2);

        setJMenuBar(MenuCRUD);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(Panel_tablas)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(Panel_tablas, javax.swing.GroupLayout.PREFERRED_SIZE, 647, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void b_T_altaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_T_altaActionPerformed

       String [] linea = new String[6];
       String [] tablas = new String[4];
      
       mani_bd dao = new mani_bd();
       int validacion=0;
       t_clase clase= new t_clase();
      t_principal principal = new t_principal();
      t_datasheet datasheet = new t_datasheet();
      t_estados estado = new t_estados();
       t_empaquetado paquete = new t_empaquetado();
       cadenas cadena = new cadenas();
       String mensaje = "";
    //  String malo = new String(com_TC_clase.getItemAt(1));
            
         //com_TC_clase.getSelectedItem().toString().;
     
       
       if ((Txt_T_componente.getBackground()!=Color.red)&&(Txt_T_componente.getText().length()>0))
           {linea[0]=cadena.aster_izq(Txt_T_componente.getText(),principal.getTa_principal()[1]);
            // validacion=false;
           }
       else{validacion++;}
       
        if ((Txt_T_cantidad.getBackground()!=Color.red)&&(Txt_T_cantidad.getText().length()>0))
           {linea[1]=cadena.cero_izq(Txt_T_cantidad.getText(),principal.getTa_principal()[4]);
                
           }
       else{validacion++;}
       
       
       if ((com_T_tipo.getBackground()!=Color.red)&&(com_T_tipo.getSelectedItem().toString().length()>0))
           {linea[2]="TIPO='"+  cadena.aster_izq(com_T_tipo.getSelectedItem().toString(),clase.getTa_clase()[2])+"'";
              tablas[0]= "CLASE";
           }
       else{validacion++;}
       
         if ((com_T_subtipo.getBackground()!=Color.red)&&(com_T_subtipo.getSelectedItem().toString().length()>0))
           {linea[2]=linea[2]+" AND SUBTIPO='"+ cadena.aster_izq(com_T_subtipo.getSelectedItem().toString(),clase.getTa_clase()[3])+"'";}
        else{validacion++;}
        
           if ((com_T_estado.getBackground()!=Color.red)&&(com_T_estado.getSelectedItem().toString().length()>0))
           {
               linea[3]="DESESTADO='" + cadena.aster_izq(com_T_estado.getSelectedItem().toString(),estado.getTa_estados()[1])+"'";
             tablas[1]= "ESTADO";
           }
       else{validacion++;}
         
         
         
         
          if ((com_T_paquete.getBackground()!=Color.red)&&(com_T_paquete.getSelectedItem().toString().length()>0))
           {linea[4]="ENCAPSULADO='"+ cadena.aster_izq(com_T_paquete.getSelectedItem().toString(),paquete.getTa_empaquetado()[1])+"'";
            tablas[2]= "EMPAQUETADO";
           }
        else{validacion++;}
              
       
        if ((Txt_T_pines.getBackground()!=Color.red)&&(Txt_T_pines.getText().length()>0))
           {linea[4]=linea[4] +"AND NUMPATILLAS='" + cadena.cero_izq(Txt_T_pines.getText(),paquete.getTa_empaquetado()[3])+"'";
              tablas[2]= "EMPAQUETADO";
           }
        else{validacion++;}
        if ((Txt_T_url.getBackground()!=Color.red)&&(Txt_T_url.getText().length()>0))
           {linea[5]="URL='"+cadena.aster_izq(Txt_T_url.getText(),datasheet.getTa_datasheet()[2])+"'";
             tablas[3]= "DATASHEET";       
           }
         else{validacion++;}
        
        if ((Txt_T_datasheet.getBackground()!=Color.red)&&(Txt_T_datasheet.getText().length()>0))
         {
             linea[5]= linea[5]+ " AND DATASHEET='"  + cadena.aster_izq(Txt_T_datasheet.getText(),datasheet.getTa_datasheet()[3])+"'";
           }
         else{validacion++;}
        
        if (validacion ==0)
       { eti_TC_mensaje.setText("");
        try {
         mensaje= dao.altasbd_principal(linea,tablas);
         eti_TC_mensaje.setText(mensaje);
        editable=false;
          } catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
             }}
       else 
       { eti_TC_mensaje.setText("Hay campos que dan error");}
        
 
    }//GEN-LAST:event_b_T_altaActionPerformed

    private void b_T_finalActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_T_finalActionPerformed
      String nombre_tablas = new String("PRINCIPAL");
      mani_bd dao = new mani_bd();
      t_clase clase= new t_clase();
      t_principal principal = new t_principal();
      t_datasheet datasheet = new t_datasheet();
      t_estados estado = new t_estados();
       t_empaquetado paquete = new t_empaquetado();
      
      int tam_elemento = clase.getTa_clase().length;
      String [] linea = new String[10];
       editable_T=false;
      
      try {linea = dao.final_reg_t_principal(nombre_tablas);}
      catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);}
    
      
      principal.setClave(linea[0]);
      principal.setComponente(linea[1]);
      clase.setTipo(linea[2]);
      clase.setSubtipo(linea[3]);
      datasheet.setUrl(linea[4]);
      datasheet.setDatasheet(linea[5]);
       principal.setCantidad(linea[6]);
       estado.setEstado(linea[7]);
      paquete.setEncapsulado(linea[8]);
      paquete.setNumpatillas(linea[9]);
     
      
       com_T_tipo.removeAllItems();
       com_T_subtipo.removeAllItems();
       com_T_estado.removeAllItems();
       com_T_paquete.removeAllItems();
         
       Txt_T_principal.setText( principal.getClave());
        com_T_tipo.addItem(clase.getTipo());
        com_T_subtipo.addItem(clase.getSubtipo());
         com_T_estado.addItem(estado.getEstado());
        com_T_paquete.addItem(paquete.getEncapsulado());
       Txt_T_pines.setText( paquete.getNumpatillas());
        Txt_T_cantidad.setText( principal.getCantidad());
        Txt_T_componente.setText( principal.getComponente());
         Txt_T_datasheet.setText(datasheet.getDatasheet());
        Txt_T_url.setText(datasheet.getUrl());
    }//GEN-LAST:event_b_T_finalActionPerformed

    private void b_T_atrasActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_T_atrasActionPerformed
            String nombre_tablas = new String("PRINCIPAL");
      mani_bd dao = new mani_bd();
      t_clase clase= new t_clase();
      t_principal principal = new t_principal();
      t_datasheet datasheet = new t_datasheet();
      t_estados estado = new t_estados();
       t_empaquetado paquete = new t_empaquetado();
       editable_T=false;
       
      int tam_elemento = clase.getTa_clase().length;
      String [] linea = new String[10];
    
      try {
          linea = dao.atras_reg_t_principal(nombre_tablas,Txt_T_principal.getText());}
      catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);}
    
      
      principal.setClave(linea[0]);
      principal.setComponente(linea[1]);
      clase.setTipo(linea[2]);
      clase.setSubtipo(linea[3]);
      datasheet.setUrl(linea[4]);
      datasheet.setDatasheet(linea[5]);
       principal.setCantidad(linea[6]);
       estado.setEstado(linea[7]);
      paquete.setEncapsulado(linea[8]);
      paquete.setNumpatillas(linea[9]);
     
      
       com_T_tipo.removeAllItems();
       com_T_subtipo.removeAllItems();
       com_T_estado.removeAllItems();
       com_T_paquete.removeAllItems();
         
       Txt_T_principal.setText( principal.getClave());
        com_T_tipo.addItem(clase.getTipo());
        com_T_subtipo.addItem(clase.getSubtipo());
         com_T_estado.addItem(estado.getEstado());
        com_T_paquete.addItem(paquete.getEncapsulado());
       Txt_T_pines.setText( paquete.getNumpatillas());
        Txt_T_cantidad.setText( principal.getCantidad());
        Txt_T_componente.setText( principal.getComponente());
         Txt_T_datasheet.setText(datasheet.getDatasheet());
        Txt_T_url.setText(datasheet.getUrl());
    }//GEN-LAST:event_b_T_atrasActionPerformed

    private void b_T_adelanteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_T_adelanteActionPerformed
         String nombre_tablas = new String("PRINCIPAL");
      mani_bd dao = new mani_bd();
      t_clase clase= new t_clase();
      t_principal principal = new t_principal();
      t_datasheet datasheet = new t_datasheet();
      t_estados estado = new t_estados();
       t_empaquetado paquete = new t_empaquetado();
       editable_T=false;
      int tam_elemento = clase.getTa_clase().length;
      String [] linea = new String[10];
    
      try {linea = dao.siguiente_reg_t_principal(nombre_tablas,Txt_T_principal.getText());}
      catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);}
    
      
      principal.setClave(linea[0]);
      principal.setComponente(linea[1]);
      clase.setTipo(linea[2]);
      clase.setSubtipo(linea[3]);
      datasheet.setUrl(linea[4]);
      datasheet.setDatasheet(linea[5]);
       principal.setCantidad(linea[6]);
       estado.setEstado(linea[7]);
      paquete.setEncapsulado(linea[8]);
      paquete.setNumpatillas(linea[9]);
     
      
       com_T_tipo.removeAllItems();
       com_T_subtipo.removeAllItems();
       com_T_estado.removeAllItems();
       com_T_paquete.removeAllItems();
         
       Txt_T_principal.setText( principal.getClave());
        com_T_tipo.addItem(clase.getTipo());
        com_T_subtipo.addItem(clase.getSubtipo());
         com_T_estado.addItem(estado.getEstado());
        com_T_paquete.addItem(paquete.getEncapsulado());
       Txt_T_pines.setText( paquete.getNumpatillas());
        Txt_T_cantidad.setText( principal.getCantidad());
        Txt_T_componente.setText( principal.getComponente());
         Txt_T_datasheet.setText(datasheet.getDatasheet());
        Txt_T_url.setText(datasheet.getUrl());
    }//GEN-LAST:event_b_T_adelanteActionPerformed

    private void Txt_T_pinesActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Txt_T_pinesActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_Txt_T_pinesActionPerformed

    private void com_T_estadoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_com_T_estadoActionPerformed
        String[] mensajeerror=new String[2];
        String caracter = new String();
        String mensaje = new String();
          t_estados estado = new t_estados ();
         mensajeerror[0] ="ERROR CAMPO NUMERO DE PINES DEBIDO A CARACTER NO NUMERICO";
         mensajeerror[1] ="ERROR CAMPO ENCAPSULADOS DEBIDO A EXCESO CARACTER";
         
         if (editable_T ==true) {
         if (com_T_estado.getSelectedItem().toString().length()>estado.getTa_estados()[1])
          { com_T_estado.setBackground(Color.red);
          if (eti_T_mensaje.getText().length()>0)
           {mensaje = eti_T_mensaje.getText();
            eti_T_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}
            else { eti_T_mensaje.setText(mensajeerror[1]);}  
            }
        else {mensaje =eti_T_mensaje.getText();
              mensaje.replaceAll(mensajeerror[1], "");
              com_T_estado.setBackground(Color.white);
               eti_T_mensaje.setText("");
                       }}
        
    }//GEN-LAST:event_com_T_estadoActionPerformed

    private void com_T_subtipoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_com_T_subtipoActionPerformed
        String[] mensajeerror=new String[2];
        String caracter = new String();
        String mensaje = new String();
          t_clase clase = new t_clase();
         mensajeerror[0] ="ERROR CAMPO NUMERO DE PINES DEBIDO A CARACTER NO NUMERICO";
         mensajeerror[1] ="ERROR CAMPO ENCAPSULADOS DEBIDO A EXCESO CARACTER";
         
         if (editable_T ==true) {
         if (com_T_subtipo.getSelectedItem().toString().length()>clase.getTa_clase()[2])
        { com_T_subtipo.setBackground(Color.red);
          if (eti_T_mensaje.getText().length()>0)
           {mensaje = eti_T_mensaje.getText();
            eti_T_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}
            else { eti_T_mensaje.setText(mensajeerror[1]);}  
            }
        else {mensaje =eti_T_mensaje.getText();
              mensaje.replaceAll(mensajeerror[1], "");
              com_T_subtipo.setBackground(Color.white);
               eti_T_mensaje.setText("");
                       }}
         editable_T=false;
    }//GEN-LAST:event_com_T_subtipoActionPerformed

    private void Txt_T_urlActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Txt_T_urlActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_Txt_T_urlActionPerformed

    private void Txt_T_principalActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Txt_T_principalActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_Txt_T_principalActionPerformed

    private void b_TC_altaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TC_altaActionPerformed
         t_clase clase= new t_clase();
       
        
        String [][] linea = new String[2][3];
        String nombre_tablas = new String("CLASE");
       mani_bd dao = new mani_bd();
       int validacion=0;
       String mensaje = "";
    //  String malo = new String(com_TC_clase.getItemAt(1));
            
         //com_TC_clase.getSelectedItem().toString().;
       if ((com_TC_clase.getBackground()!=Color.red)&&(com_TC_clase.getSelectedItem().toString().length()>0))
           {linea[0][0]=com_TC_clase.getSelectedItem().toString();
            // validacion=false;
           }
       else{validacion++;}
       
       if ((com_TC_tipo.getBackground()!=Color.red)&&(com_TC_tipo.getSelectedItem().toString().length()>0))
           {linea[0][1]=com_TC_tipo.getSelectedItem().toString();}
       else{validacion++;}
       
         if ((com_TC_subtipo.getBackground()!=Color.red)&&(com_TC_subtipo.getSelectedItem().toString().length()>0))
           {linea[0][2]=com_TC_subtipo.getSelectedItem().toString();}
        else{validacion++;}
             
       if (validacion ==0)
       { eti_TC_mensaje.setText("");
        try {
         mensaje= dao.altasbd_clase(linea, nombre_tablas, clase.getTa_clase());
         eti_TC_mensaje.setText(mensaje);
        editable=false;
          } catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
             }}
       else 
       { eti_TC_mensaje.setText("Hay campos que dan error");}
    }//GEN-LAST:event_b_TC_altaActionPerformed

    private void b_TC_finalActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TC_finalActionPerformed
         String nombre_tablas = new String("CLASE");
      mani_bd dao = new mani_bd();
      t_clase clase= new t_clase();
      int tam_elemento = clase.getTa_clase().length;
      String [][] linea = new String[0][tam_elemento];
      linea = dao.final_registro(nombre_tablas,clase.getTa_clase());
      
      clase.setClave(linea[0][0]);
      clase.setClase(linea[0][1]);
      clase.setTipo(linea[0][2]);
      clase.setSubtipo(linea[0][3]);
     
       com_TC_clase.removeAllItems();
       com_TC_tipo.removeAllItems();
       com_TC_subtipo.removeAllItems();
      
      
       Txt_TC_principal.setText( clase.getClave());
        com_TC_clase.addItem(clase.getClase());
        com_TC_tipo.addItem(clase.getTipo());
        com_TC_subtipo.addItem(clase.getSubtipo());
    }//GEN-LAST:event_b_TC_finalActionPerformed

    private void b_TC_atrasActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TC_atrasActionPerformed
         String nombre_tablas = new String("CLASE");
      mani_bd dao = new mani_bd();
      t_clase clase= new t_clase();
      int tam_elemento = clase.getTa_clase().length;
      String [][] linea = new String[0][tam_elemento];
      linea = dao.anterior_registro(nombre_tablas,Txt_TC_principal.getText(),clase.getTa_clase());
      
      clase.setClave(linea[0][0]);
      clase.setClase(linea[0][1]);
      clase.setTipo(linea[0][2]);
      clase.setSubtipo(linea[0][3]);
     
       com_TC_clase.removeAllItems();
       com_TC_tipo.removeAllItems();
       com_TC_subtipo.removeAllItems();
      
      
       Txt_TC_principal.setText( clase.getClave());
        com_TC_clase.addItem(clase.getClase());
        com_TC_tipo.addItem(clase.getTipo());
        com_TC_subtipo.addItem(clase.getSubtipo());
    }//GEN-LAST:event_b_TC_atrasActionPerformed

    private void b_TC_adelanteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TC_adelanteActionPerformed
        String nombre_tablas = new String("CLASE");
      mani_bd dao = new mani_bd();
      t_clase clase= new t_clase();
      int tam_elemento = clase.getTa_clase().length;
      String [][] linea = new String[0][tam_elemento];
    try {
        linea = dao.siguiente_registro(nombre_tablas, Txt_TC_principal.getText(),clase.getTa_clase());
    } catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
    }
      
      clase.setClave(linea[0][0]);
      clase.setClase(linea[0][1]);
      clase.setTipo(linea[0][2]);
      clase.setSubtipo(linea[0][3]);
      
      com_TC_clase.removeAllItems();
       com_TC_tipo.removeAllItems();
       com_TC_subtipo.removeAllItems();
      
       Txt_TC_principal.setText( clase.getClave());
        com_TC_clase.addItem(clase.getClase());
        com_TC_tipo.addItem(clase.getTipo());
        com_TC_subtipo.addItem(clase.getSubtipo());
    }//GEN-LAST:event_b_TC_adelanteActionPerformed

    private void Txt_TC_principalActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Txt_TC_principalActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_Txt_TC_principalActionPerformed

    private void Txt_TP_principalActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Txt_TP_principalActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_Txt_TP_principalActionPerformed

    private void Txt_TP_urlActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Txt_TP_urlActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_Txt_TP_urlActionPerformed

    private void Txt_TP_npatillas1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Txt_TP_npatillas1ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_Txt_TP_npatillas1ActionPerformed
    
    private void b_TP_finalActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TP_finalActionPerformed
            String nombre_tablas = new String("EMPAQUETADO");
      mani_bd dao = new mani_bd();
      t_empaquetado paquete= new t_empaquetado();
      int tam_elemento = paquete.getTa_empaquetado().length;
      String [][] linea = new String[0][tam_elemento];
      linea = dao.final_registro(nombre_tablas,paquete.getTa_empaquetado());
      
      paquete.setClave(linea[0][0]);
      paquete.setDescripcion(linea[0][2]);
      paquete.setEncapsulado(linea[0][1]);
      paquete.setNumpatillas(linea[0][3]);
      paquete.setUrl(linea[0][4]);
      
       Txt_TP_principal.setText(paquete.getClave());
        Txt_TP_descripcion1.setText(paquete.getDescripcion());
        Txt_TP_url.setText(paquete.getUrl());
        Txt_TP_encapsulado1.setText(paquete.getEncapsulado());
         Txt_TP_npatillas1.setText(paquete.getNumpatillas());
    }//GEN-LAST:event_b_TP_finalActionPerformed

    private void b_TP_bajaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TP_bajaActionPerformed
       String [][] recuperado = new String[2][4];
          String nombre_tablas = new String("EMPAQUETADO");
       cadenas cadena = new cadenas();
        mani_bd dao = new mani_bd();
        t_empaquetado paquete = new t_empaquetado();
        recuperado[0][0]=cadena.aster_izq(Txt_TP_encapsulado1.getText(),paquete.getTa_empaquetado()[1]);
        recuperado[0][1]=cadena.aster_izq(Txt_TP_descripcion1.getText(),paquete.getTa_empaquetado()[2]);
        recuperado[0][2]=cadena.cero_izq(Txt_TP_npatillas1.getText(),paquete.getTa_empaquetado()[3]);
        recuperado[0][3]=cadena.aster_izq(Txt_TP_url.getText(),paquete.getTa_empaquetado()[4]);
        
 try {
       eti_TP_mensaje.setText(dao.bajabd_paquete(nombre_tablas, Txt_TP_principal.getText(), recuperado,"8"));
      //  dao.actualizaindices(nombre_tablas,Txt_TP_principal.getText() );
      
      dao.primer_registro(nombre_tablas, paquete.getTa_empaquetado());
    } catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
    }
        
        
    }//GEN-LAST:event_b_TP_bajaActionPerformed

    private void Txt_TE_principalActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Txt_TE_principalActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_Txt_TE_principalActionPerformed

    private void Txt_TE_estadoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Txt_TE_estadoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_Txt_TE_estadoActionPerformed

    private void b_TE_principioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TE_principioActionPerformed
       String nombre_tablas = new String("ESTADO");
          mani_bd dao = new mani_bd();
          t_estados estado= new t_estados();
          int tam_elemento = estado.getTa_estados().length;
          String [][] linea = new String[0][tam_elemento];
          linea = dao.primer_registro(nombre_tablas,estado.getTa_estados());
      
          estado.setClave(linea[0][0]);
          estado.setEstado(linea[0][1]);
          Txt_TE_principal.setText(estado.getClave());
          Txt_TE_estado.setText(estado.getEstado()); 
    }//GEN-LAST:event_b_TE_principioActionPerformed

    private void b_TE_finalActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TE_finalActionPerformed
        String nombre_tablas = new String("ESTADO");
      mani_bd dao = new mani_bd();
      t_estados estado= new t_estados();
      int tam_elemento = estado.getTa_estados().length;
      String [][] linea = new String[0][tam_elemento];
      
      linea = dao.final_registro(nombre_tablas,estado.getTa_estados());
      
      estado.setClave(linea[0][0]);
      estado.setEstado(linea[0][1]);
         
       Txt_TE_principal.setText(estado.getClave());
        Txt_TE_estado.setText(estado.getEstado());
    }//GEN-LAST:event_b_TE_finalActionPerformed

    private void b_TE_bajaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TE_bajaActionPerformed
          String [][] recuperado = new String[2][1];
          String nombre_tablas = new String("ESTADO");
          cadenas cadena = new cadenas();
           mani_bd dao = new mani_bd();
           t_estados estado = new t_estados();
           recuperado[0][0]=cadena.aster_izq(Txt_TE_estado.getText(),estado.getTa_estados()[1]);
             
     try { eti_TD_mensaje.setText(dao.bajabd_estado(nombre_tablas, Txt_TE_principal.getText(), recuperado,"7"));
          // dao.actualizaindices(nombre_tablas,Txt_TE_principal.getText() );
           dao.primer_registro(nombre_tablas, estado.getTa_estados());
    } catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
    }
        
    }//GEN-LAST:event_b_TE_bajaActionPerformed

    private void Txt_TD_principalActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Txt_TD_principalActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_Txt_TD_principalActionPerformed

    private void Txt_TD_urlActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Txt_TD_urlActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_Txt_TD_urlActionPerformed

    private void Txt_TD_descripcionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Txt_TD_descripcionActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_Txt_TD_descripcionActionPerformed

    private void b_TD_principioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TD_principioActionPerformed
      String nombre_tablas = new String("DATASHEET");
      mani_bd dao = new mani_bd();
      t_datasheet datasheet= new t_datasheet();
      int tam_elemento = datasheet.getTa_datasheet().length;
      String [][] linea = new String[0][tam_elemento];
      linea = dao.primer_registro(nombre_tablas,datasheet.getTa_datasheet());
      
      datasheet.setClave(linea[0][0]);
      datasheet.setCodigotabla(linea[0][2]);
      datasheet.setUrl(linea[0][1]);
      datasheet.setDatasheet(linea[0][3]);
      datasheet.setDescripcion(linea[0][4]);
       datasheet.setFecha(linea[0][5]);
       
       Txt_TD_principal.setText(datasheet.getClave());
       Txt_TD_url.setText( datasheet.getUrl());
       Txt_TD_Datasheet.setText(datasheet.getDatasheet());
        Txt_TD_descripcion.setText(datasheet.getDescripcion());
          
         
         
    }//GEN-LAST:event_b_TD_principioActionPerformed

    private void b_TD_finalActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TD_finalActionPerformed
       String nombre_tablas = new String("DATASHEET");
      mani_bd dao = new mani_bd();
      t_datasheet datasheet= new t_datasheet();
      int tam_elemento = datasheet.getTa_datasheet().length;
      String [][] linea = new String[0][tam_elemento];
      linea = dao.final_registro(nombre_tablas,datasheet.getTa_datasheet());
      
      datasheet.setClave(linea[0][0]);
      datasheet.setCodigotabla(linea[0][1]);
      datasheet.setUrl(linea[0][2]);
      datasheet.setDatasheet(linea[0][3]);
      datasheet.setDescripcion(linea[0][4]);
       datasheet.setFecha(linea[0][5]);
       
       Txt_TD_principal.setText(datasheet.getClave());
       Txt_TD_url.setText( datasheet.getUrl());
       Txt_TD_Datasheet.setText(datasheet.getDatasheet());
        Txt_TD_descripcion.setText(datasheet.getDescripcion());
    }//GEN-LAST:event_b_TD_finalActionPerformed

    private void b_TD_bajaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TD_bajaActionPerformed
        String [][] recuperado = new String[2][3];
         String nombre_tablas = new String("DATASHEET");
       cadenas cadena = new cadenas();
        mani_bd dao = new mani_bd();
         t_datasheet datasheet= new t_datasheet();
        recuperado[0][0]=cadena.aster_izq( Txt_TD_url.getText(),datasheet.getTa_datasheet()[2]);
        recuperado[0][1]=cadena.aster_izq( Txt_TD_Datasheet.getText(),datasheet.getTa_datasheet()[3]);
        recuperado[0][2]=cadena.aster_izq(Txt_TD_descripcion.getText(),datasheet.getTa_datasheet()[4]);
       
        
       try {
           eti_TD_mensaje.setText( dao.bajabd_datasheet(nombre_tablas, Txt_TD_principal.getText(), recuperado,"6"));
            //dao.actualizaindices(nombre_tablas,Txt_TD_principal.getText() );
            dao.primer_registro(nombre_tablas, datasheet.getTa_datasheet());
          } catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
    }
    }//GEN-LAST:event_b_TD_bajaActionPerformed

    private void b_llenartablaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_llenartablaActionPerformed
      int elementos_lista =0;
      int tam_listay =0;
      int tamao_lista=0;
      int ultimo_registro_tabla=0;
      int ultimo_registro_moviminetos=0;
      
      
      
      String nombre_tablas = new String("EMPAQUETADO");
      String nombre_movimientos = new String("MOVIMIENTOS");
         
      ArrayList lista = new ArrayList();
      mani_bd manipul = new mani_bd();
      cadenas cad = new cadenas();
      t_empaquetado paquete = new t_empaquetado();
      
    try {
        ultimo_registro_moviminetos = manipul.numeroregistro(nombre_movimientos);
        ultimo_registro_tabla = manipul.numeroregistro(nombre_tablas);
    } catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
    }
      
      
          
      lista = manipul.listado(txt_directorio.getText()); //Lectura secuencial de ficheros 
    //Pasa Lista a Array y da formato correcto 
      String cadena_lista = new String();
      tamao_lista= lista.size();
      cadena_lista = (String)lista.get(0);
      elementos_lista=cadena_lista.split(";").length;
      String [][]arrayneta1= new String[tamao_lista][elementos_lista];
      arrayneta1= cad.matrizlimpia(lista);
    //Fin Pasa Lista a Array y da formato correcto
        
    //PREPARANDO TRAMA PREELIMINAR
      tamao_lista = arrayneta1.length;
      elementos_lista= arrayneta1[0].length;
      String [][]preeliminar1= new String[tamao_lista][elementos_lista+2]; 
      preeliminar1=cad.tra_preeliminar(arrayneta1,paquete.getTa_empaquetado());
     //FIN TRAMA PREELIMINAR
         
     
   //PREPARANDO TRAMA MOVIMIENTOS
      tamao_lista = preeliminar1.length;
      String [][]movimientos1= new String[tamao_lista][6];
      movimientos1= cad.tra_movimientos(preeliminar1,ultimo_registro_moviminetos);
    //FIN PREPARANDO TRAMA MOVIMIENTOS 
      
        preeliminar1=manipul.comprobacion(nombre_tablas, preeliminar1,ultimo_registro_tabla, 6);
    
    
    
    
    //CREACION SQL TABLAS
      tamao_lista = preeliminar1.length;
      tam_listay = preeliminar1[0].length;
      String [] tablavalues1= new String[tamao_lista] ;
      tablavalues1 = cad.formatoSQL(preeliminar1);
    //FIN CREACION SQL TABLAS
      
    //CREACION SQL MOVIMIENTOS
      tamao_lista = movimientos1.length;
      tam_listay = movimientos1[0].length;
      String [] movimientosvalues1= new String[tamao_lista] ;
      movimientosvalues1 = cad.formatoSQL(movimientos1);
    //FIN CREACION SQL MOVIMIENTOS
      
    //ESCRITURA BASE DATOS 
      
      manipul.insertomasivobd(nombre_tablas, nombre_movimientos, movimientosvalues1, tablavalues1);
    //ESCRITURA BASE DATOS 
        
    }//GEN-LAST:event_b_llenartablaActionPerformed

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
         int devuelto =0;
      
        JFileChooser selectorArchivo = new JFileChooser();
         devuelto= selectorArchivo.showOpenDialog(this);
         
      
      if ( devuelto == JFileChooser.APPROVE_OPTION)
        {File archivoSeleccionado = selectorArchivo.getSelectedFile();
          JOptionPane.showMessageDialog(this, "Ruta: "+archivoSeleccionado.getParent());
          txt_directorio.setText(archivoSeleccionado.getParent());
        
        }
      else 
           {JOptionPane.showMessageDialog(this, "Seleccion un archivo... "); }
    }//GEN-LAST:event_jButton1ActionPerformed

    private void Txt_TP_encapsulado1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Txt_TP_encapsulado1ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_Txt_TP_encapsulado1ActionPerformed

    private void Txt_TP_descripcion1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Txt_TP_descripcion1ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_Txt_TP_descripcion1ActionPerformed
    public void Panel_tablasMouseClicked(java.awt.event.MouseEvent evt)  {  
         
      if (CRUD_T_clase.isShowing()== true )
        {   String nombre_tablas = new String("CLASE");
             mani_bd dao = new mani_bd();
             t_clase clase= new t_clase();
             int tam_elemento = clase.getTa_clase().length;
             String [][] linea = new String[0][tam_elemento];
              linea = dao.primer_registro(nombre_tablas,clase.getTa_clase());
      
             clase.setClave(linea[0][0]);
             clase.setClase(linea[0][1]);
             clase.setTipo(linea[0][2]);
             clase.setSubtipo(linea[0][3]);
     
            com_TC_clase.removeAllItems();
            com_TC_tipo.removeAllItems();
            com_TC_subtipo.removeAllItems();
         
            Txt_TC_principal.setText( clase.getClave());
             com_TC_clase.addItem(clase.getClase());
             com_TC_tipo.addItem(clase.getTipo());
             com_TC_subtipo.addItem(clase.getSubtipo());    
        }
      
      if (CRUD_T_empaquetado.isShowing()== true )
        { 
           String nombre_tablas = new String("EMPAQUETADO");
           mani_bd dao = new mani_bd();
           t_empaquetado paquete= new t_empaquetado();
           int tam_elemento = paquete.getTa_empaquetado().length;
           String [][] linea = new String[0][tam_elemento];
           linea = dao.primer_registro(nombre_tablas,paquete.getTa_empaquetado());
      
          paquete.setClave(linea[0][0]);
          paquete.setDescripcion(linea[0][2]);
          paquete.setEncapsulado(linea[0][1]);
          paquete.setNumpatillas(linea[0][3]);
          paquete.setUrl(linea[0][4]);
      
          Txt_TP_principal.setText(paquete.getClave());
          Txt_TP_descripcion1.setText(paquete.getDescripcion());
           Txt_TP_url.setText(paquete.getUrl());
          Txt_TP_encapsulado1.setText(paquete.getEncapsulado());
          Txt_TP_npatillas1.setText(paquete.getNumpatillas());
        }
      
      if (CRUD_T_estado.isShowing()== true )
        { String nombre_tablas = new String("ESTADO");
          mani_bd dao = new mani_bd();
          t_estados estado= new t_estados();
          int tam_elemento = estado.getTa_estados().length;
          String [][] linea = new String[0][tam_elemento];
          linea = dao.primer_registro(nombre_tablas,estado.getTa_estados());
      
          estado.setClave(linea[0][0]);
          estado.setEstado(linea[0][1]);
          Txt_TE_principal.setText(estado.getClave());
          Txt_TE_estado.setText(estado.getEstado()); 
      
        }
      if (CRUD_T_principal.isShowing()== true )
        {//JOptionPane.showMessageDialog(null,"Eres un cretino \n");
        }
    
      if (CRUD_T_datasheet.isShowing()== true )
        {String nombre_tablas = new String("DATASHEET");
      mani_bd dao = new mani_bd();
      t_datasheet datasheet= new t_datasheet();
      int tam_elemento = datasheet.getTa_datasheet().length;
      String [][] linea = new String[0][tam_elemento];
      linea = dao.primer_registro(nombre_tablas,datasheet.getTa_datasheet());
      
      datasheet.setClave(linea[0][0]);
      datasheet.setCodigotabla(linea[0][2]);
      datasheet.setUrl(linea[0][1]);
      datasheet.setDatasheet(linea[0][3]);
      datasheet.setDescripcion(linea[0][4]);
       datasheet.setFecha(linea[0][5]);
       
       Txt_TD_principal.setText(datasheet.getClave());
       Txt_TD_url.setText( datasheet.getUrl());
       Txt_TD_Datasheet.setText(datasheet.getDatasheet());
        Txt_TD_descripcion.setText(datasheet.getDescripcion()); }
    }
    
    private void Panel_tablasMouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_Panel_tablasMouseEntered
       //Se activa cunado pasas el puntero por encima del panel
        if (CRUD_T_clase.isShowing()== true )
        {
        // JOptionPane.showMessageDialog(null,"Eres un cretino \n");
              
        }

        // TODO add your handling code here:
    }//GEN-LAST:event_Panel_tablasMouseEntered
/*
    private void Panel_tablasMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_Panel_tablasMouseClicked
        capullo=1;
    }//GEN-LAST:event_Panel_tablasMouseClicked
*/
    private void b_TC_principioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TC_principioActionPerformed
      String nombre_tablas = new String("CLASE");
      mani_bd dao = new mani_bd();
      t_clase clase= new t_clase();
      int tam_elemento = clase.getTa_clase().length;
      String [][] linea = new String[0][tam_elemento];
      linea = dao.primer_registro(nombre_tablas,clase.getTa_clase());
      
      clase.setClave(linea[0][0]);
      clase.setClase(linea[0][1]);
      clase.setTipo(linea[0][2]);
      clase.setSubtipo(linea[0][3]);
     
       com_TC_clase.removeAllItems();
       com_TC_tipo.removeAllItems();
       com_TC_subtipo.removeAllItems();
         
       Txt_TC_principal.setText( clase.getClave());
        com_TC_clase.addItem(clase.getClase());
        com_TC_tipo.addItem(clase.getTipo());
        com_TC_subtipo.addItem(clase.getSubtipo());
      
          
    }//GEN-LAST:event_b_TC_principioActionPerformed

    private void b_TP_adelanteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TP_adelanteActionPerformed

   String nombre_tablas = new String("EMPAQUETADO");
      mani_bd dao = new mani_bd();
      t_empaquetado paquete= new t_empaquetado();
      int tam_elemento = paquete.getTa_empaquetado().length;
      String [][] linea = new String[0][tam_elemento];
    try {
        linea = dao.siguiente_registro(nombre_tablas,Txt_TP_principal.getText(),paquete.getTa_empaquetado());
    } catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
    }
      
      paquete.setClave(linea[0][0]);
      paquete.setDescripcion(linea[0][2]);
      paquete.setEncapsulado(linea[0][1]);
      paquete.setNumpatillas(linea[0][3]);
      paquete.setUrl(linea[0][4]);
      
       Txt_TP_principal.setText(paquete.getClave());
        Txt_TP_descripcion1.setText(paquete.getDescripcion());
        Txt_TP_url.setText(paquete.getUrl());
        Txt_TP_encapsulado1.setText(paquete.getEncapsulado());
         Txt_TP_npatillas1.setText(paquete.getNumpatillas());
      // TODO add your handling code here:
    }//GEN-LAST:event_b_TP_adelanteActionPerformed

    private void b_TP_principioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TP_principioActionPerformed
            String nombre_tablas = new String("EMPAQUETADO");
      mani_bd dao = new mani_bd();
      t_empaquetado paquete= new t_empaquetado();
      int tam_elemento = paquete.getTa_empaquetado().length;
      String [][] linea = new String[0][tam_elemento];
      linea = dao.primer_registro(nombre_tablas,paquete.getTa_empaquetado());
      
      paquete.setClave(linea[0][0]);
      paquete.setDescripcion(linea[0][2]);
      paquete.setEncapsulado(linea[0][1]);
      paquete.setNumpatillas(linea[0][3]);
      paquete.setUrl(linea[0][4]);
      
       Txt_TP_principal.setText(paquete.getClave());
        Txt_TP_descripcion1.setText(paquete.getDescripcion());
        Txt_TP_url.setText(paquete.getUrl());
        Txt_TP_encapsulado1.setText(paquete.getEncapsulado());
         Txt_TP_npatillas1.setText(paquete.getNumpatillas());
    }//GEN-LAST:event_b_TP_principioActionPerformed

    private void b_TP_atrasActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TP_atrasActionPerformed
        String nombre_tablas = new String("EMPAQUETADO");
      mani_bd dao = new mani_bd();
      t_empaquetado paquete= new t_empaquetado();
      int tam_elemento = paquete.getTa_empaquetado().length;
      String [][] linea = new String[0][tam_elemento];
      linea = dao.anterior_registro(nombre_tablas,Txt_TP_principal.getText(),paquete.getTa_empaquetado());
      
      paquete.setClave(linea[0][0]);
      paquete.setDescripcion(linea[0][2]);
      paquete.setEncapsulado(linea[0][1]);
      paquete.setNumpatillas(linea[0][3]);
      paquete.setUrl(linea[0][4]);
      
       Txt_TP_principal.setText(paquete.getClave());
        Txt_TP_descripcion1.setText(paquete.getDescripcion());
        Txt_TP_url.setText(paquete.getUrl());
        Txt_TP_encapsulado1.setText(paquete.getEncapsulado());
         Txt_TP_npatillas1.setText(paquete.getNumpatillas());
    }//GEN-LAST:event_b_TP_atrasActionPerformed

    private void b_TP_nuevoregistroActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TP_nuevoregistroActionPerformed
        
         String nombre_tablas = new String("EMPAQUETADO");
         int clave =0;
      mani_bd dao = new mani_bd();
    try {
        clave=dao.numeroregistro(nombre_tablas);
        Txt_TP_principal.setText(Integer.toString(clave));
         Txt_TP_descripcion1.setText("");
        Txt_TP_url.setText("");
        Txt_TP_encapsulado1.setText("");
         Txt_TP_npatillas1.setText("");
    } catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
    }
      
        
        
        
    }//GEN-LAST:event_b_TP_nuevoregistroActionPerformed

    private void Txt_TP_npatillas1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Txt_TP_npatillas1KeyPressed
      
        
      
    }//GEN-LAST:event_Txt_TP_npatillas1KeyPressed

    private void Txt_TP_encapsulado1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Txt_TP_encapsulado1KeyPressed
        
        String[] mensajeerror=new String[2];
        String caracter = new String();
        String mensaje = new String();
         t_empaquetado paquete= new t_empaquetado();
         mensajeerror[0] ="ERROR CAMPO NUMERO DE PINES DEBIDO A CARACTER NO NUMERICO";
         mensajeerror[1] ="ERROR CAMPO ENCAPSULADOS DEBIDO A EXCESO CARACTER";
         
       if (Txt_TP_encapsulado1.getText().length()>paquete.getTa_empaquetado()[1])
        { Txt_TP_encapsulado1.setBackground(Color.red);
          if (eti_TP_mensaje.getText().length()>0)
           {mensaje = eti_TP_mensaje.getText();
            eti_TP_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}
            else { eti_TP_mensaje.setText(mensajeerror[1]);}  
            }
        else {mensaje =eti_TP_mensaje.getText();
              mensaje.replaceAll(mensajeerror[1], "");
              Txt_TP_encapsulado1.setBackground(Color.white);
               eti_TP_mensaje.setText(mensaje);
                       }
    }//GEN-LAST:event_Txt_TP_encapsulado1KeyPressed

    private void Txt_TP_descripcion1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Txt_TP_descripcion1KeyPressed
        String[] mensajeerror=new String[2];
        String caracter = new String();
        String mensaje = new String();
         t_empaquetado paquete= new t_empaquetado();
         mensajeerror[0] ="ERROR CAMPO NUMERO DE PINES DEBIDO A CARACTER NO NUMERICO";
         mensajeerror[1] ="ERROR CAMPO DESCRIPCION DEBIDO A EXCESO CARACTER";
         
       if (Txt_TP_descripcion1.getText().length()>paquete.getTa_empaquetado()[2])
        { Txt_TP_descripcion1.setBackground(Color.red);
          if (eti_TP_mensaje.getText().length()>0)
           {mensaje = eti_TP_mensaje.getText();
            eti_TP_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}
            else { eti_TP_mensaje.setText(mensajeerror[1]);}  
            }
        else {mensaje =eti_TP_mensaje.getText();
              mensaje.replaceAll(mensajeerror[1], "");
              Txt_TP_descripcion1.setBackground(Color.white);
               eti_TP_mensaje.setText(mensaje);
                       }
    }//GEN-LAST:event_Txt_TP_descripcion1KeyPressed

    private void Txt_TP_urlKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Txt_TP_urlKeyPressed
        String[] mensajeerror=new String[2];
        String caracter = new String();
        String mensaje = new String();
         t_empaquetado paquete= new t_empaquetado();
         mensajeerror[0] ="ERROR CAMPO URL DEBIDO A FORMATO NO VALIDO URL";
         mensajeerror[1] ="ERROR CAMPO URL DEBIDO A EXCESO CARACTER";
         boolean error=false;
         String[] schemes = {"http","https"}; // DEFAULT schemes = "http", "https", "ftp"
         UrlValidator urlValidato = new UrlValidator(schemes);
         
         if (urlValidato.isValid(Txt_TP_url.getText())) 
          {// mensaje =eti_mensaje.getText();
             Txt_TP_url.setBackground(Color.white);
               eti_TP_mensaje.setText("");}
         
         else { Txt_TP_url.setBackground(Color.red);
                if (eti_TP_mensaje.getText().length()>0)
                 {mensaje = eti_TP_mensaje.getText();
                   eti_TP_mensaje.setText(mensaje + "\n"+ mensajeerror[0]);}
                 else { eti_TP_mensaje.setText(mensajeerror[0]);}
                  error =true;}
                  
     
         if (Txt_TP_url.getText().length()>paquete.getTa_empaquetado()[4])
          { if (error==true)
             { Txt_TP_url.setBackground(Color.red);
               if (eti_TP_mensaje.getText().length()>0)
                {mensaje = eti_TP_mensaje.getText();
                 eti_TP_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}
                else { Txt_TP_url.setBackground(Color.red);
                      eti_TP_mensaje.setText(mensajeerror[1]);}}}
            
           else if (error==true)
                 { Txt_TP_url.setBackground(Color.red);
                   if (eti_TP_mensaje.getText().length()>0)
                    {mensaje = eti_TP_mensaje.getText();
                     eti_TP_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}
                    else { Txt_TP_url.setBackground(Color.red);
                         eti_TP_mensaje.setText(mensajeerror[1]);}}
                 else { Txt_TP_url.setBackground(Color.white);
                        eti_TP_mensaje.setText("");}
          
    }//GEN-LAST:event_Txt_TP_urlKeyPressed

    private void b_TP_altaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TP_altaActionPerformed
       String [][] linea = new String[2][4];
        String nombre_tablas = new String("EMPAQUETADO");
       mani_bd dao = new mani_bd();
       int validacion=0;
      
       t_empaquetado paquete = new t_empaquetado();
       
            
       if ((Txt_TP_encapsulado1.getBackground()!=Color.red)&&(Txt_TP_encapsulado1.getText().length()>0))
           {linea[0][0]=Txt_TP_encapsulado1.getText();
            // validacion=false;
           }
       else{validacion++;}
       
       if ((Txt_TP_descripcion1.getBackground()!=Color.red)&&(Txt_TP_descripcion1.getText().length()>0))
           {linea[0][1]=Txt_TP_descripcion1.getText();
             // validacion=false;
           }
       else{validacion++;}
       
        if ((Txt_TP_npatillas1.getBackground()!=Color.red)&&(Txt_TP_npatillas1.getText().length()>0))
           {linea[0][2]=Txt_TP_npatillas1.getText();
           }
        else{validacion++;}
        if ((Txt_TP_url.getBackground()!=Color.red)&&(Txt_TP_url.getText().length()>0))
           {linea[0][3]=Txt_TP_url.getText();}
         else{validacion++;}
      
       if (validacion ==0)
       { eti_TP_mensaje.setText("");
        try {
        dao.altasbd(linea, nombre_tablas, paquete.getTa_empaquetado());
          } catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
             }}
       else 
       { eti_TP_mensaje.setText("Hay campos que dan error");}
        
    }//GEN-LAST:event_b_TP_altaActionPerformed

    private void Txt_TP_npatillas1KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Txt_TP_npatillas1KeyReleased
          String[] mensajeerror=new String[2];
        String caracter = new String();
        String mensaje = new String();
        cadenas cadena = new cadenas();
        boolean error=false;
         t_empaquetado paquete= new t_empaquetado();
         mensajeerror[0] ="ERROR CAMPO NUMERO DE PINES DEBIDO A CARACTER NO NUMERICO";
         mensajeerror[1] ="ERROR CAMPO NUMERO DE PINES DEBIDO A EXCESO CARACTER";
         
      //  caracter= Character.toString(evt.getKeyChar());
        caracter=  Txt_TP_npatillas1.getText();
          if (cadena.comparacadena(caracter)== false)
           { Txt_TP_npatillas1.setBackground(Color.red);
             if (eti_TP_mensaje.getText().length()>0)
              {mensaje = eti_TP_mensaje.getText();
               eti_TP_mensaje.setText(mensaje + "\n"+ mensajeerror[0]);}
              else { eti_TP_mensaje.setText(mensajeerror[0]);} 
                     error=true;}
           
          else {mensaje =eti_TP_mensaje.getText();
                   mensaje.replaceAll(mensajeerror[0], "");
                   Txt_TP_npatillas1.setBackground(Color.white);
                   eti_TP_mensaje.setText(mensaje); 
                    error =false;}
           
                 
          if (caracter.length()> paquete.getTa_empaquetado()[3])
                { if (error==true)
                   {Txt_TP_npatillas1.setBackground(Color.red);
                    if (eti_TP_mensaje.getText().length()>0)
                      {mensaje = eti_TP_mensaje.getText();
                       eti_TP_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}}
                  else{Txt_TP_npatillas1.setBackground(Color.red);
                        eti_TP_mensaje.setText(mensajeerror[1]);} }
        
          else { if (error==true)
                   {Txt_TP_npatillas1.setBackground(Color.red);}
                   // if (eti_mensaje.getText().length()>0)
                    //  {mensaje = eti_mensaje.getText();}}
                 else{ Txt_TP_npatillas1.setBackground(Color.white);
                          eti_TP_mensaje.setText(""); }}
 
    }//GEN-LAST:event_Txt_TP_npatillas1KeyReleased

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
        String nombre_tablas = new String("EMPAQUETADO");
        mani_bd DAO = new mani_bd();
        
    try {
        DAO.actualizaindices(nombre_tablas, "000000");
    } catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
    }
        
        
    }//GEN-LAST:event_jButton2ActionPerformed

    private void b_TP_modificarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TP_modificarActionPerformed
         String [][] linea = new String[2][4];
        String nombre_tablas = new String("EMPAQUETADO");
        String clave= new String();
        cadenas cadena = new cadenas();
       mani_bd dao = new mani_bd();
       
       int validacion=0;
       
       t_empaquetado paquete = new t_empaquetado();
     
        if ((Txt_TP_encapsulado1.getBackground()!=Color.red)&&(Txt_TP_encapsulado1.getText().length()>0))
           {paquete.setEncapsulado(cadena.aster_izq(Txt_TP_encapsulado1.getText(),paquete.getTa_empaquetado()[1]));
           linea[0][0]=Txt_TP_encapsulado1.getText();
           }
       else{validacion++;}
       
       if ((Txt_TP_descripcion1.getBackground()!=Color.red)&&(Txt_TP_descripcion1.getText().length()>0))
           {linea[0][1]=Txt_TP_descripcion1.getText();
            paquete.setDescripcion(cadena.aster_izq(Txt_TP_descripcion1.getText(),paquete.getTa_empaquetado()[2]));
           }
       else{validacion++;}
       
        if ((Txt_TP_npatillas1.getBackground()!=Color.red)&&(Txt_TP_npatillas1.getText().length()>0))
           {linea[0][2]=Txt_TP_npatillas1.getText();
            paquete.setNumpatillas(cadena.cero_izq(Txt_TP_npatillas1.getText(),paquete.getTa_empaquetado()[3]));
           }
        else{validacion++;}
        if ((Txt_TP_url.getBackground()!=Color.red)&&(Txt_TP_url.getText().length()>0))
           {paquete.setUrl(cadena.aster_izq(Txt_TP_url.getText(),paquete.getTa_empaquetado()[4]));
             linea[0][3]=Txt_TP_url.getText();}
         else{validacion++;}
      
        clave = Txt_TP_principal.getText();
       paquete.setClave(cadena.cero_izq(clave,6));
               
       if (validacion ==0)
       { eti_TP_mensaje.setText("");
       
         String result = "UPDATE "+ nombre_tablas+ " SET ENCAPSULADO='"+paquete.getEncapsulado()+"',"
              + "DESCRIPCION = '"+paquete.getDescripcion()+"',"
              + "NUMPATILLAS = '"+paquete.getNumpatillas()+"',"
              + "URL = '"+paquete.getUrl()+"'"
              + "WHERE CLAVE='"+paquete.getClave()+"'";
                   
        try {dao.modificacionbd(linea, nombre_tablas, paquete.getTa_empaquetado(),paquete.getClave(),"8","2",result);}
        catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
             }}
       else 
       { eti_TP_mensaje.setText("Hay campos que dan error");}
    }//GEN-LAST:event_b_TP_modificarActionPerformed

    private void b_TE_adelanteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TE_adelanteActionPerformed
        String nombre_tablas = new String("ESTADO");
      mani_bd dao = new mani_bd();
      t_estados estado= new t_estados();
      int tam_elemento = estado.getTa_estados().length;
      String [][] linea = new String[0][tam_elemento];
      
      try {
           linea = dao.siguiente_registro(nombre_tablas,Txt_TE_principal.getText(),estado.getTa_estados());
          } catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
         }
      
      estado.setClave(linea[0][0]);
      estado.setEstado(linea[0][1]);
         
       Txt_TE_principal.setText(estado.getClave());
        Txt_TE_estado.setText(estado.getEstado());
        
    }//GEN-LAST:event_b_TE_adelanteActionPerformed

    private void b_TE_atrasActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TE_atrasActionPerformed
      String nombre_tablas = new String("ESTADO");
      mani_bd dao = new mani_bd();
      t_estados estado= new t_estados();
      int tam_elemento = estado.getTa_estados().length;
      String [][] linea = new String[0][tam_elemento];
      
      linea = dao.anterior_registro(nombre_tablas,Txt_TE_principal.getText(),estado.getTa_estados());
      
      estado.setClave(linea[0][0]);
      estado.setEstado(linea[0][1]);
         
       Txt_TE_principal.setText(estado.getClave());
        Txt_TE_estado.setText(estado.getEstado());
    }//GEN-LAST:event_b_TE_atrasActionPerformed

    private void b_TP_confirmar1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TP_confirmar1ActionPerformed
         String nombre_tablas = new String("ESTADO");
         int clave =0;
         mani_bd dao = new mani_bd();
        
        try { clave=dao.numeroregistro(nombre_tablas);
              Txt_TE_principal.setText(Integer.toString(clave));
               Txt_TE_estado.setText("");
      
            } catch (SQLException ex) {
                   Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
                           }
    }//GEN-LAST:event_b_TP_confirmar1ActionPerformed

    private void b_TE_altaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TE_altaActionPerformed
       String [][] linea = new String[2][1];
       String nombre_tablas = new String("ESTADO");
       mani_bd dao = new mani_bd();
       int validacion=0;
      
       t_estados estado = new t_estados();
                 
       if ((Txt_TE_estado.getBackground()!=Color.red)&&(Txt_TE_estado.getText().length()>0))
           {linea[0][0]=Txt_TE_estado.getText();}
       else{validacion++;}
                   
       if (validacion ==0)
         {eti_TE_mensaje.setText("");
        try {dao.altasbd_estado(linea, nombre_tablas, estado.getTa_estados());
             } catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
             }}
       else  { eti_TE_mensaje.setText("Hay campos que dan error");}
    }//GEN-LAST:event_b_TE_altaActionPerformed

    private void b_TE_modificarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TE_modificarActionPerformed
        String [][] linea = new String[2][1];
        String nombre_tablas = new String("ESTADO");
        String clave= new String();
        cadenas cadena = new cadenas();
       mani_bd dao = new mani_bd();
       
       int validacion=0;
       
       t_estados estado = new t_estados();
     
        if ((Txt_TE_estado.getBackground()!=Color.red)&&(Txt_TE_estado.getText().length()>0))
           {estado.setEstado(cadena.aster_izq(Txt_TE_estado.getText(),estado.getTa_estados()[1]));
           linea[0][0]=Txt_TE_estado.getText();
           }
       else{validacion++;}
       
       clave = Txt_TE_principal.getText();
       estado.setClave(cadena.cero_izq(clave,6));
               
       if (validacion ==0)
       { eti_TE_mensaje.setText("");
       
         String result = "UPDATE "+ nombre_tablas+ " SET DESESTADO='"+estado.getEstado()+"' "
                        + "WHERE CLAVE='"+estado.getClave()+"'";
                   
        try {dao.modificacionbd_estado(linea, nombre_tablas, estado.getTa_estados(),estado.getClave(),"7","2",result);}
        catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
             }}
       else 
       { eti_TE_mensaje.setText("Hay campos que dan error");}
    }//GEN-LAST:event_b_TE_modificarActionPerformed

    private void Txt_TE_estadoKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Txt_TE_estadoKeyPressed
        String[] mensajeerror=new String[2];
        String caracter = new String();
        String mensaje = new String();
         t_estados estado= new t_estados();
         mensajeerror[0] ="ERROR CAMPO NUMERO DE PINES DEBIDO A CARACTER NO NUMERICO";
         mensajeerror[1] ="ERROR CAMPO ENCAPSULADOS DEBIDO A EXCESO CARACTER";
         
       if (Txt_TE_estado.getText().length()>estado.getTa_estados()[1])
        { Txt_TE_estado.setBackground(Color.red);
          if (eti_TE_mensaje.getText().length()>0)
           {mensaje = eti_TE_mensaje.getText();
            eti_TE_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}
            else { eti_TE_mensaje.setText(mensajeerror[1]);}  
            }
        else {mensaje =eti_TE_mensaje.getText();
              mensaje.replaceAll(mensajeerror[1], "");
              Txt_TE_estado.setBackground(Color.white);
               eti_TE_mensaje.setText(mensaje);}
    }//GEN-LAST:event_Txt_TE_estadoKeyPressed

    private void Txt_TD_DatasheetActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Txt_TD_DatasheetActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_Txt_TD_DatasheetActionPerformed

    private void b_TD_adelanteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TD_adelanteActionPerformed
      String nombre_tablas = new String("DATASHEET");
      mani_bd dao = new mani_bd();
      t_datasheet datasheet= new t_datasheet();
      int tam_elemento = datasheet.getTa_datasheet().length;
      String [][] linea = new String[0][tam_elemento];
    
      try {
        linea = dao.siguiente_registro(nombre_tablas,Txt_TD_principal.getText(),datasheet.getTa_datasheet());
        } catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex); }
      
           
      datasheet.setClave(linea[0][0]);
      datasheet.setCodigotabla(linea[0][2]);
      datasheet.setUrl(linea[0][1]);
      datasheet.setDatasheet(linea[0][3]);
      datasheet.setDescripcion(linea[0][4]);
       datasheet.setFecha(linea[0][5]);
       
       Txt_TD_principal.setText(datasheet.getClave());
       Txt_TD_url.setText( datasheet.getUrl());
       Txt_TD_Datasheet.setText(datasheet.getDatasheet());
        Txt_TD_descripcion.setText(datasheet.getDescripcion());
    }//GEN-LAST:event_b_TD_adelanteActionPerformed

    private void b_TD_atrasActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TD_atrasActionPerformed
       String nombre_tablas = new String("DATASHEET");
      mani_bd dao = new mani_bd();
      t_datasheet datasheet= new t_datasheet();
      int tam_elemento = datasheet.getTa_datasheet().length;
      String [][] linea = new String[0][tam_elemento];
      linea = dao.anterior_registro(nombre_tablas,Txt_TD_principal.getText(),datasheet.getTa_datasheet());
      
      datasheet.setClave(linea[0][0]);
      datasheet.setCodigotabla(linea[0][2]);
      datasheet.setUrl(linea[0][1]);
      datasheet.setDatasheet(linea[0][3]);
      datasheet.setDescripcion(linea[0][4]);
       datasheet.setFecha(linea[0][5]);
       
       Txt_TD_principal.setText(datasheet.getClave());
       Txt_TD_url.setText( datasheet.getUrl());
       Txt_TD_Datasheet.setText(datasheet.getDatasheet());
        Txt_TD_descripcion.setText(datasheet.getDescripcion());
    }//GEN-LAST:event_b_TD_atrasActionPerformed

    private void b_TD_nuevoregistroActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TD_nuevoregistroActionPerformed
       String nombre_tablas = new String("DATASHEET");
         int clave =0;
      mani_bd dao = new mani_bd();
    try {
        clave=dao.numeroregistro(nombre_tablas);
         Txt_TD_principal.setText(Integer.toString(clave));
         Txt_TD_url.setText("");
         Txt_TD_Datasheet.setText("");
         Txt_TD_descripcion.setText("");
         
    } catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
    }
    }//GEN-LAST:event_b_TD_nuevoregistroActionPerformed

    private void b_TD_altaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TD_altaActionPerformed
        String [][] linea = new String[2][3];
        String nombre_tablas = new String("DATASHEET");
       mani_bd dao = new mani_bd();
       int validacion=0;
      
       t_datasheet datasheet= new t_datasheet();
                  
       if ((Txt_TD_url.getBackground()!=Color.red)&&(Txt_TD_url.getText().length()>0))
           {linea[0][0]=Txt_TD_url.getText();
            // validacion=false;
           }
       else{validacion++;}
       
       if ((Txt_TD_Datasheet.getBackground()!=Color.red)&&(Txt_TD_Datasheet.getText().length()>0))
           {linea[0][1]=Txt_TD_Datasheet.getText();
             // validacion=false;
           }
       else{validacion++;}
       
        if ((Txt_TD_descripcion.getBackground()!=Color.red)&&(Txt_TD_descripcion.getText().length()>0))
           {linea[0][2]=Txt_TD_descripcion.getText();
           }
        else{validacion++;}
             
       if (validacion ==0)
       { eti_TD_mensaje.setText("");
        try {
             dao.altasbd_datasheet(linea, nombre_tablas, datasheet.getTa_datasheet());
          } catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
             }}
       else 
       { eti_TD_mensaje.setText("Hay campos que dan error");}
    }//GEN-LAST:event_b_TD_altaActionPerformed

    private void b_TD_modificarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TD_modificarActionPerformed
        String [][] linea = new String[2][3];
       String nombre_tablas = new String("DATASHEET");
        String clave= new String();
        cadenas cadena = new cadenas();
       mani_bd dao = new mani_bd();
       
       int validacion=0;
       
      t_datasheet datasheet= new t_datasheet();
     
        if ((Txt_TD_url.getBackground()!=Color.red)&&(Txt_TD_url.getText().length()>0))
           {datasheet.setUrl(cadena.aster_izq(Txt_TD_url.getText(),datasheet.getTa_datasheet()[2]));
           linea[0][0]=Txt_TD_url.getText();
           }
       else{validacion++;}
       
       if ((Txt_TD_Datasheet.getBackground()!=Color.red)&&(Txt_TD_Datasheet.getText().length()>0))
           {linea[0][1]=Txt_TD_Datasheet.getText();
            datasheet.setDatasheet(cadena.aster_izq(Txt_TD_Datasheet.getText(),datasheet.getTa_datasheet()[3]));
           }
       else{validacion++;}
       
        if ((Txt_TD_descripcion.getBackground()!=Color.red)&&(Txt_TD_descripcion.getText().length()>0))
           {linea[0][2]=Txt_TD_descripcion.getText();
            datasheet.setDescripcion(cadena.aster_izq(Txt_TD_descripcion.getText(),datasheet.getTa_datasheet()[4]));
           }
        else{validacion++;}
       
      
        clave = Txt_TD_principal.getText();
       datasheet.setClave(cadena.cero_izq(clave,6));
               
       if (validacion ==0)
       { eti_TD_mensaje.setText("");
       
         String result = "UPDATE "+ nombre_tablas+ " SET CODTABLAPRIM='000000',"
              + "URL = '"+datasheet.getUrl()+"',"
              + "DATASHEET = '"+datasheet.getDatasheet()+"',"
              + "DESCRIPCION = '"+datasheet.getDescripcion()+"'"
              + "WHERE CLAVE='"+datasheet.getClave()+"'";
                   
        try {dao.modificacionbd_clase(linea, nombre_tablas, datasheet.getTa_datasheet(),datasheet.getClave(),"6","2",result);}
        catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
             }}
       else 
       { eti_TD_mensaje.setText("Hay campos que dan error");}
    }//GEN-LAST:event_b_TD_modificarActionPerformed

    private void Txt_TD_urlKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Txt_TD_urlKeyPressed
      String[] mensajeerror=new String[2];
        String caracter = new String();
        String mensaje = new String();
         t_datasheet datasheet= new t_datasheet();
         mensajeerror[0] ="ERROR CAMPO URL DEBIDO A FORMATO NO VALIDO URL";
         mensajeerror[1] ="ERROR CAMPO URL DEBIDO A EXCESO CARACTER";
         boolean error=false;
         String[] schemes = {"http","https"}; // DEFAULT schemes = "http", "https", "ftp"
         UrlValidator urlValidato = new UrlValidator(schemes);
         
         if (urlValidato.isValid(Txt_TD_url.getText())) 
          {// mensaje =eti_mensaje.getText();
             Txt_TD_url.setBackground(Color.white);
               eti_TD_mensaje.setText("");}
         
         else { Txt_TD_url.setBackground(Color.red);
                if (eti_TD_mensaje.getText().length()>0)
                 {mensaje = eti_TD_mensaje.getText();
                   eti_TD_mensaje.setText(mensaje + "\n"+ mensajeerror[0]);}
                 else { eti_TD_mensaje.setText(mensajeerror[0]);}
                  error =true;}
                  
     
         if (Txt_TD_url.getText().length()>datasheet.getTa_datasheet()[2])
          { if (error==true)
             { Txt_TD_url.setBackground(Color.red);
               if (eti_TD_mensaje.getText().length()>0)
                {mensaje = eti_TD_mensaje.getText();
                 eti_TD_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}
                else { Txt_TD_url.setBackground(Color.red);
                      eti_TD_mensaje.setText(mensajeerror[1]);}}}
            
           else if (error==true)
                 { Txt_TD_url.setBackground(Color.red);
                   if (eti_TD_mensaje.getText().length()>0)
                    {mensaje = eti_TD_mensaje.getText();
                     eti_TD_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}
                    else { Txt_TD_url.setBackground(Color.red);
                         eti_TD_mensaje.setText(mensajeerror[1]);}}
                 else { Txt_TD_url.setBackground(Color.white);
                        eti_TD_mensaje.setText("");}
    }//GEN-LAST:event_Txt_TD_urlKeyPressed

    private void Txt_TD_DatasheetKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Txt_TD_DatasheetKeyPressed
         String[] mensajeerror=new String[2];
        String caracter = new String();
        String mensaje = new String();
          t_datasheet datasheet= new t_datasheet();
         mensajeerror[0] ="ERROR CAMPO NUMERO DE PINES DEBIDO A CARACTER NO NUMERICO";
         mensajeerror[1] ="ERROR CAMPO ENCAPSULADOS DEBIDO A EXCESO CARACTER";
         
       if (Txt_TD_Datasheet.getText().length()>datasheet.getTa_datasheet()[3])
        { Txt_TD_Datasheet.setBackground(Color.red);
          if (eti_TD_mensaje.getText().length()>0)
           {mensaje = eti_TD_mensaje.getText();
            eti_TD_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}
            else { eti_TD_mensaje.setText(mensajeerror[1]);}  
            }
        else {mensaje =eti_TD_mensaje.getText();
              mensaje.replaceAll(mensajeerror[1], "");
              Txt_TD_Datasheet.setBackground(Color.white);
               eti_TD_mensaje.setText(mensaje);
                       }
    }//GEN-LAST:event_Txt_TD_DatasheetKeyPressed

    private void Txt_TD_descripcionKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Txt_TD_descripcionKeyPressed
       String[] mensajeerror=new String[2];
        String caracter = new String();
        String mensaje = new String();
          t_datasheet datasheet= new t_datasheet();
         mensajeerror[0] ="ERROR CAMPO NUMERO DE PINES DEBIDO A CARACTER NO NUMERICO";
         mensajeerror[1] ="ERROR CAMPO ENCAPSULADOS DEBIDO A EXCESO CARACTER";
         
       if (Txt_TD_descripcion.getText().length()>datasheet.getTa_datasheet()[4])
        { Txt_TD_descripcion.setBackground(Color.red);
          if (eti_TD_mensaje.getText().length()>0)
           {mensaje = eti_TD_mensaje.getText();
            eti_TD_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}
            else { eti_TD_mensaje.setText(mensajeerror[1]);}  
            }
        else {mensaje =eti_TD_mensaje.getText();
              mensaje.replaceAll(mensajeerror[1], "");
              Txt_TD_descripcion.setBackground(Color.white);
               eti_TD_mensaje.setText(mensaje);
                       }
    }//GEN-LAST:event_Txt_TD_descripcionKeyPressed

    private void b_TD_buscarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TD_buscarActionPerformed
        int devuelto =0;
      
        JFileChooser selectorArchivo = new JFileChooser();
         devuelto= selectorArchivo.showOpenDialog(this);
         
      
      if ( devuelto == JFileChooser.APPROVE_OPTION)
        {File archivoSeleccionado = selectorArchivo.getSelectedFile();
          JOptionPane.showMessageDialog(this, "Ruta: "+archivoSeleccionado.getParent());
          Txt_TD_Datasheet.setText(archivoSeleccionado.getParent()+"\\"+archivoSeleccionado.getName());
        
        }
      else 
           {JOptionPane.showMessageDialog(this, "Seleccion un archivo... "); }
    }//GEN-LAST:event_b_TD_buscarActionPerformed

    private void com_TC_tipoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_com_TC_tipoActionPerformed
         String[] mensajeerror=new String[2];
        String caracter = new String();
        String mensaje = new String();
          t_clase clase = new t_clase();
         mensajeerror[0] ="ERROR CAMPO NUMERO DE PINES DEBIDO A CARACTER NO NUMERICO";
         mensajeerror[1] ="ERROR CAMPO ENCAPSULADOS DEBIDO A EXCESO CARACTER";
      
           if (editable ==true) 
           {
       if (com_TC_tipo.getSelectedItem().toString().length()>clase.getTa_clase()[1])
        { com_TC_tipo.setBackground(Color.red);
          if (eti_TC_mensaje.getText().length()>0)
           {mensaje = eti_TC_mensaje.getText();
            eti_TC_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}
            else { eti_TC_mensaje.setText(mensajeerror[1]);}  
            }
        else {mensaje =eti_TC_mensaje.getText();
              mensaje.replaceAll(mensajeerror[1], "");
              com_TC_tipo.setBackground(Color.white);
               eti_TC_mensaje.setText("");
                       }}
    }//GEN-LAST:event_com_TC_tipoActionPerformed

    private void com_TC_subtipoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_com_TC_subtipoActionPerformed
         String[] mensajeerror=new String[2];
        String caracter = new String();
        String mensaje = new String();
          t_clase clase = new t_clase();
         mensajeerror[0] ="ERROR CAMPO NUMERO DE PINES DEBIDO A CARACTER NO NUMERICO";
         mensajeerror[1] ="ERROR CAMPO ENCAPSULADOS DEBIDO A EXCESO CARACTER";
         
         if (editable ==true) {
         if (com_TC_subtipo.getSelectedItem().toString().length()>clase.getTa_clase()[2])
        { com_TC_subtipo.setBackground(Color.red);
          if (eti_TC_mensaje.getText().length()>0)
           {mensaje = eti_TC_mensaje.getText();
            eti_TC_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}
            else { eti_TC_mensaje.setText(mensajeerror[1]);}  
            }
        else {mensaje =eti_TC_mensaje.getText();
              mensaje.replaceAll(mensajeerror[1], "");
              com_TC_subtipo.setBackground(Color.white);
               eti_TC_mensaje.setText("");
                       }}
         editable=false;
    }//GEN-LAST:event_com_TC_subtipoActionPerformed

    private void b_TC_BajaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TC_BajaActionPerformed
       String [][] recuperado = new String[2][3];
          String nombre_tablas = new String("CLASE");
           String mensaje = new String();
       cadenas cadena = new cadenas();
        mani_bd dao = new mani_bd();
        t_clase clase = new t_clase();
        recuperado[0][0]=cadena.aster_izq(com_TC_clase.getSelectedItem().toString(),clase.getTa_clase()[1]);
        recuperado[0][1]=cadena.aster_izq(com_TC_tipo.getSelectedItem().toString(),clase.getTa_clase()[2]);
        recuperado[0][2]=cadena.aster_izq(com_TC_subtipo.getSelectedItem().toString(),clase.getTa_clase()[3]);
      
        
 try {
        mensaje =dao.bajabd_clase(nombre_tablas, Txt_TC_principal.getText(), recuperado,"5");
       eti_TC_mensaje.setText(mensaje);
     //  dao.actualizaindices(nombre_tablas,Txt_TC_principal.getText() );
      dao.primer_registro(nombre_tablas, clase.getTa_clase());
    } catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
    }
        
    }//GEN-LAST:event_b_TC_BajaActionPerformed

    private void b_TC_modificacionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TC_modificacionActionPerformed
         String [][] linea = new String[2][3];
        String nombre_tablas = new String("CLASE");
        String clave= new String();
        cadenas cadena = new cadenas();
       mani_bd dao = new mani_bd();
       String mensaje ="";
       
       int validacion=0;
       
       t_clase clase = new t_clase();
     
        if ((com_TC_clase.getBackground()!=Color.red)&&(com_TC_clase.getSelectedItem().toString().length()>0))
           {linea[0][0]=com_TC_clase.getSelectedItem().toString();
            clase.setClase(cadena.aster_izq(linea[0][0],clase.getTa_clase()[1]));
           }
       else{validacion++;}
       
       if ((com_TC_tipo.getBackground()!=Color.red)&&(com_TC_tipo.getSelectedItem().toString().length()>0))
           {linea[0][1]=com_TC_tipo.getSelectedItem().toString();
            clase.setTipo(cadena.aster_izq(linea[0][1],clase.getTa_clase()[2])); 
           }
       else{validacion++;}
       
         if ((com_TC_subtipo.getBackground()!=Color.red)&&(com_TC_subtipo.getSelectedItem().toString().length()>0))
           {linea[0][2]=com_TC_subtipo.getSelectedItem().toString();
            clase.setSubtipo(cadena.aster_izq(linea[0][2],clase.getTa_clase()[3]));
           }
        else{validacion++;}
       
      
        clave = Txt_TC_principal.getText();
       clase.setClave(cadena.cero_izq(clave,6));
               
       if (validacion ==0)
       { eti_TC_mensaje.setText("");
       
         String result = "UPDATE "+ nombre_tablas+ " SET CLASE='"+clase.getClase()+"',"
              + "TIPO = '"+clase.getTipo()+"',"
              + "SUBTIPO = '"+clase.getSubtipo()+ "' WHERE CLAVE='"+clase.getClave()+"'";
                         
        try {mensaje=dao.modificacionbd_clase(linea, nombre_tablas, clase.getTa_clase(),clase.getClave(),"5","2",result);
       eti_TC_mensaje.setText(mensaje);
        editable=false;}
        catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
             }}
       else 
       { eti_TC_mensaje.setText("Hay campos que dan error");}
    }//GEN-LAST:event_b_TC_modificacionActionPerformed

    private void b_TC_nuevoregistroActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TC_nuevoregistroActionPerformed
       String nombre_tablas = new String("CLASE");
       int clave =0;
       cadenas cadena = new cadenas();
       mani_bd dao = new mani_bd();
       t_clase clase = new t_clase();
       int tamlistclase=0;
       int tamlisttipo=0;
       int tamlistsubtipo=0;
       int i=0;
     
       try {
        clave=dao.numeroregistro(nombre_tablas);
        Txt_TC_principal.setText(Integer.toString(clave));
        
         com_TC_clase.removeAllItems();
       com_TC_tipo.removeAllItems();
       com_TC_subtipo.removeAllItems();
       
         com_TC_clase.addItem("");
        com_TC_tipo.addItem("");
        com_TC_subtipo.addItem("");
        
        list_TC_clase=dao.listar_campos(nombre_tablas,2,clase.getTa_clase()[1]);
        list_TC_tipo=dao.listar_campos(nombre_tablas,3,clase.getTa_clase()[2]);
        list_TC_subtipo=dao.listar_campos(nombre_tablas,4,clase.getTa_clase()[3]);
        
        list_TC_clase = cadena.quita_repetidos(list_TC_clase);
        list_TC_tipo = cadena.quita_repetidos(list_TC_tipo);
        list_TC_subtipo = cadena.quita_repetidos(list_TC_subtipo);
        
        
         tamlistclase=list_TC_clase.size();
         tamlisttipo=list_TC_tipo.size();
        tamlistsubtipo=list_TC_subtipo.size();
        
    
        for (i=0;i<tamlisttipo;i++)
         {com_TC_tipo.addItem(list_TC_tipo.get(i).toString());}
        
        for (i=0;i<tamlistsubtipo;i++)
         {com_TC_subtipo.addItem(list_TC_subtipo.get(i).toString());}
        
        for (i=0;i<tamlistclase;i++)
         {com_TC_clase.addItem(list_TC_clase.get(i).toString());}
        editable=true;
        
    } catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
    }
    }//GEN-LAST:event_b_TC_nuevoregistroActionPerformed

    private void com_TC_claseActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_com_TC_claseActionPerformed
       
        String[] mensajeerror=new String[2];
        String caracter = new String();
        String mensaje = new String();
          t_clase clase = new t_clase();
         mensajeerror[0] ="ERROR CAMPO NUMERO DE PINES DEBIDO A CARACTER NO NUMERICO";
         mensajeerror[1] ="ERROR CAMPO ENCAPSULADOS DEBIDO A EXCESO CARACTER";
       
        if (editable ==true) 
         {eti_TC_mensaje.setText(evt.getActionCommand().toString());
     
         if (com_TC_clase.getSelectedItem().toString().length()>clase.getTa_clase()[1])
        { com_TC_clase.setBackground(Color.red);
          if (eti_TC_mensaje.getText().length()>0)
           {mensaje = eti_TC_mensaje.getText();
            eti_TC_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}
            else { eti_TC_mensaje.setText(mensajeerror[1]);}  
            }
        else {mensaje =eti_TC_mensaje.getText();
              mensaje.replaceAll("",mensajeerror[1] );
              com_TC_clase.setBackground(Color.white);
               eti_TC_mensaje.setText("");}}
        
    
        
    }//GEN-LAST:event_com_TC_claseActionPerformed

    private void b_TC_modificacion1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TC_modificacion1ActionPerformed
      
       String nombre_tablas = new String("CLASE");
       int clave =0;
       cadenas cadena = new cadenas();
       mani_bd dao = new mani_bd();
       t_clase clase = new t_clase();
       int tamlistclase=0;
       int tamlisttipo=0;
       int tamlistsubtipo=0;
       int i=0;
        
        
        list_TC_clase=dao.listar_campos(nombre_tablas,2,clase.getTa_clase()[1]);
        list_TC_tipo=dao.listar_campos(nombre_tablas,3,clase.getTa_clase()[2]);
        list_TC_subtipo=dao.listar_campos(nombre_tablas,4,clase.getTa_clase()[3]);
        
        list_TC_clase = cadena.quita_repetidos(list_TC_clase);
        list_TC_tipo = cadena.quita_repetidos(list_TC_tipo);
        list_TC_subtipo = cadena.quita_repetidos(list_TC_subtipo);
        
        
         tamlistclase=list_TC_clase.size();
         tamlisttipo=list_TC_tipo.size();
        tamlistsubtipo=list_TC_subtipo.size();
        
    
        for (i=0;i<tamlisttipo;i++)
         {com_TC_tipo.addItem(list_TC_tipo.get(i).toString());}
        
        for (i=0;i<tamlistsubtipo;i++)
         {com_TC_subtipo.addItem(list_TC_subtipo.get(i).toString());}
        
        for (i=0;i<tamlistclase;i++)
         {com_TC_clase.addItem(list_TC_clase.get(i).toString());}
        editable=true;
    }//GEN-LAST:event_b_TC_modificacion1ActionPerformed

    private void b_llenartabla1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_llenartabla1ActionPerformed
       
        iofile fichero = new iofile();
         int tamao_lista =0;
        ArrayList lista = new ArrayList();
        cadenas cadena = new  cadenas();
         mani_bd dao = new mani_bd();
     //   lista = fichero.listado_datasheet(txt_directorio.getText());
  //      tamao_lista = lista.size();
        String [] trama_datasheet = new String[tamao_lista];
        String [] trama_movimientos = new String[tamao_lista];
      
    try {
        dao.actualizaindices_INV("CLASE","77");
        
        
        // trama_datasheet=cadena.tra_datasheet(lista, txt_directorio.getText());
        // trama_movimientos = cadena.tra_movimientos2(0,tamao_lista);
        //dao.insertomasivobd("DATASHEET", "MOVIMIENTOS", trama_movimientos, trama_datasheet);
    } catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
    }
           
        
    }//GEN-LAST:event_b_llenartabla1ActionPerformed

    private void com_T_paqueteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_com_T_paqueteActionPerformed
         String[] mensajeerror=new String[2];
        String caracter = new String();
        String mensaje = new String();
          t_empaquetado paquete = new t_empaquetado ();
         mensajeerror[0] ="ERROR CAMPO NUMERO DE PINES DEBIDO A CARACTER NO NUMERICO";
         mensajeerror[1] ="ERROR CAMPO ENCAPSULADOS DEBIDO A EXCESO CARACTER";
         
         if (editable_T ==true) {
         if (com_T_paquete.getSelectedItem().toString().length()>paquete.getTa_empaquetado()[2])
          { com_T_paquete.setBackground(Color.red);
          if (eti_T_mensaje.getText().length()>0)
           {mensaje = eti_T_mensaje.getText();
            eti_T_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}
            else { eti_T_mensaje.setText(mensajeerror[1]);}  
            }
        else {mensaje =eti_T_mensaje.getText();
              mensaje.replaceAll(mensajeerror[1], "");
              com_T_paquete.setBackground(Color.white);
               eti_T_mensaje.setText("");
                       }}
       //  editable_T=true;
    }//GEN-LAST:event_com_T_paqueteActionPerformed

    private void Txt_T_cantidadActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Txt_T_cantidadActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_Txt_T_cantidadActionPerformed

    private void b_T_buscarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_T_buscarActionPerformed
       int devuelto =0;
      
        JFileChooser selectorArchivo = new JFileChooser();
         devuelto= selectorArchivo.showOpenDialog(this);
         
      
      if ( devuelto == JFileChooser.APPROVE_OPTION)
        {File archivoSeleccionado = selectorArchivo.getSelectedFile();
          JOptionPane.showMessageDialog(this, "Ruta: "+archivoSeleccionado.getParent());
          Txt_T_datasheet.setText(archivoSeleccionado.getParent()+"\\"+archivoSeleccionado.getName());
        
        }
      else 
           {JOptionPane.showMessageDialog(this, "Seleccion un archivo... "); }
    }//GEN-LAST:event_b_T_buscarActionPerformed

    private void b_T_modificacion2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_T_modificacion2ActionPerformed
       String nombre_tablas = new String("CLASE");
       String nombre_tablas1 = new String("ESTADO");
       String nombre_tablas2 = new String("EMPAQUETADO");
       int clave =0;
       cadenas cadena = new cadenas();
       mani_bd dao = new mani_bd();
       t_clase clase = new t_clase();
       t_empaquetado paquete = new t_empaquetado ();
       t_estados estado = new t_estados ();
       
       int tamlisttipo=0;
       int tamlistsubtipo=0;
       int tamlistpaquete=0;
       int tamlistestado=0;
       
       int i=0;
              
        list_T_tipo=dao.listar_campos(nombre_tablas,3,clase.getTa_clase()[2]);
        list_T_subtipo=dao.listar_campos(nombre_tablas,4,clase.getTa_clase()[3]);
        list_T_paquete=dao.listar_campos(nombre_tablas2,2,clase.getTa_clase()[1]);
        list_T_estado =dao.listar_campos(nombre_tablas1,2,clase.getTa_clase()[1]);        
       
        list_T_tipo = cadena.quita_repetidos(list_T_tipo);
        list_T_subtipo = cadena.quita_repetidos(list_T_subtipo);
        list_T_paquete = cadena.quita_repetidos(list_T_paquete);
        list_T_estado = cadena.quita_repetidos(list_T_estado);
          
        tamlisttipo=list_T_tipo.size();
        tamlistsubtipo=list_T_subtipo.size();
        tamlistpaquete=list_T_paquete.size();
        tamlistestado=list_T_estado.size();
           
         for (i=0;i<tamlisttipo;i++)
         {com_T_tipo.addItem(list_T_tipo.get(i).toString());}
        
        for (i=0;i<tamlistsubtipo;i++)
         {com_T_subtipo.addItem(list_T_subtipo.get(i).toString());}
        
        for (i=0;i<tamlistpaquete;i++)
         {com_T_paquete.addItem(list_T_paquete.get(i).toString());}
        
        for (i=0;i<tamlistestado;i++)
         {com_T_estado.addItem(list_T_estado.get(i).toString());}
               
        editable_T=true;
    }//GEN-LAST:event_b_T_modificacion2ActionPerformed

    private void com_T_tipoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_com_T_tipoActionPerformed
      String[] mensajeerror=new String[2];
        String caracter = new String();
        String mensaje = new String();
          t_clase clase = new t_clase();
         mensajeerror[0] ="ERROR CAMPO NUMERO DE PINES DEBIDO A CARACTER NO NUMERICO";
         mensajeerror[1] ="ERROR CAMPO ENCAPSULADOS DEBIDO A EXCESO CARACTER";
      
           if (editable_T ==true) 
           {
       if (com_T_tipo.getSelectedItem().toString().length()>clase.getTa_clase()[1])
        { com_T_tipo.setBackground(Color.red);
          if (eti_T_mensaje.getText().length()>0)
           {mensaje = eti_T_mensaje.getText();
            eti_T_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}
            else { eti_T_mensaje.setText(mensajeerror[1]);}  
            }
        else {mensaje =eti_T_mensaje.getText();
              mensaje.replaceAll(mensajeerror[1], "");
              com_T_tipo.setBackground(Color.white);
               eti_T_mensaje.setText("");
                       }}
    }//GEN-LAST:event_com_T_tipoActionPerformed

    private void Txt_T_componenteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Txt_T_componenteActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_Txt_T_componenteActionPerformed

    private void Txt_T_datasheetActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Txt_T_datasheetActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_Txt_T_datasheetActionPerformed

    private void Txt_T_datasheetKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Txt_T_datasheetKeyPressed
      
         String[] mensajeerror=new String[2];
        String caracter = new String();
        String mensaje = new String();
          t_datasheet datasheet= new t_datasheet();
         mensajeerror[0] ="ERROR CAMPO NUMERO DE PINES DEBIDO A CARACTER NO NUMERICO";
         mensajeerror[1] ="ERROR CAMPO ENCAPSULADOS DEBIDO A EXCESO CARACTER";
         
       if (Txt_T_datasheet.getText().length()>datasheet.getTa_datasheet()[3])
        { Txt_T_datasheet.setBackground(Color.red);
          if (eti_T_mensaje.getText().length()>0)
           {mensaje = eti_T_mensaje.getText();
            eti_T_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}
            else { eti_T_mensaje.setText(mensajeerror[1]);}  
            }
        else {mensaje =eti_T_mensaje.getText();
              mensaje.replaceAll(mensajeerror[1], "");
              Txt_T_datasheet.setBackground(Color.white);
               eti_T_mensaje.setText(mensaje);
                       }
        
        
        
        
        
        
        
        
       
    }//GEN-LAST:event_Txt_T_datasheetKeyPressed

    private void Txt_T_urlKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Txt_T_urlKeyPressed
       String[] mensajeerror=new String[2];
        String caracter = new String();
        String mensaje = new String();
         t_empaquetado paquete= new t_empaquetado();
         mensajeerror[0] ="ERROR CAMPO URL DEBIDO A FORMATO NO VALIDO URL";
         mensajeerror[1] ="ERROR CAMPO URL DEBIDO A EXCESO CARACTER";
         boolean error=false;
         String[] schemes = {"http","https"}; // DEFAULT schemes = "http", "https", "ftp"
         UrlValidator urlValidato = new UrlValidator(schemes);
         
         if (urlValidato.isValid(Txt_T_url.getText())) 
          {// mensaje =eti_mensaje.getText();
             Txt_T_url.setBackground(Color.white);
               eti_T_mensaje.setText("");}
         
         else { Txt_T_url.setBackground(Color.red);
                if (eti_T_mensaje.getText().length()>0)
                 {mensaje = eti_T_mensaje.getText();
                   eti_T_mensaje.setText(mensaje + "\n"+ mensajeerror[0]);}
                 else { eti_T_mensaje.setText(mensajeerror[0]);}
                  error =true;}
                  
     
         if (Txt_T_url.getText().length()>paquete.getTa_empaquetado()[4])
          { if (error==true)
             { Txt_T_url.setBackground(Color.red);
               if (eti_T_mensaje.getText().length()>0)
                {mensaje = eti_T_mensaje.getText();
                 eti_T_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}
                else { Txt_T_url.setBackground(Color.red);
                      eti_T_mensaje.setText(mensajeerror[1]);}}}
            
           else if (error==true)
                 { Txt_T_url.setBackground(Color.red);
                   if (eti_T_mensaje.getText().length()>0)
                    {mensaje = eti_T_mensaje.getText();
                     eti_T_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}
                    else { Txt_T_url.setBackground(Color.red);
                         eti_T_mensaje.setText(mensajeerror[1]);}}
                 else { Txt_T_url.setBackground(Color.white);
                        eti_T_mensaje.setText("");}
    }//GEN-LAST:event_Txt_T_urlKeyPressed

    private void Txt_T_componenteKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Txt_T_componenteKeyPressed
        String[] mensajeerror=new String[2];
        String caracter = new String();
        String mensaje = new String();
          t_principal principal= new t_principal();
         mensajeerror[0] ="ERROR CAMPO NUMERO DE PINES DEBIDO A CARACTER NO NUMERICO";
         mensajeerror[1] ="ERROR CAMPO ENCAPSULADOS DEBIDO A EXCESO CARACTER";
         
       if (Txt_T_componente.getText().length()>principal.getTa_principal()[1])
        { Txt_T_componente.setBackground(Color.red);
          if (eti_T_mensaje.getText().length()>0)
           {mensaje = eti_T_mensaje.getText();
            eti_T_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}
            else { eti_T_mensaje.setText(mensajeerror[1]);}  
            }
        else {mensaje =eti_T_mensaje.getText();
              mensaje.replaceAll(mensajeerror[1], "");
              Txt_T_componente.setBackground(Color.white);
               eti_T_mensaje.setText(mensaje);
                       }
    }//GEN-LAST:event_Txt_T_componenteKeyPressed

    private void Txt_T_cantidadKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Txt_T_cantidadKeyPressed
        String[] mensajeerror=new String[2];
        String caracter = new String();
        String mensaje = new String();
          t_principal principal= new t_principal();
         mensajeerror[0] ="ERROR CAMPO NUMERO DE PINES DEBIDO A CARACTER NO NUMERICO";
         mensajeerror[1] ="ERROR CAMPO ENCAPSULADOS DEBIDO A EXCESO CARACTER";
         
       if (Txt_T_cantidad.getText().length()>principal.getTa_principal()[4])
        { Txt_T_cantidad.setBackground(Color.red);
          if (eti_T_mensaje.getText().length()>0)
           {mensaje = eti_T_mensaje.getText();
            eti_T_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}
            else { eti_T_mensaje.setText(mensajeerror[1]);}  
            }
        else {mensaje =eti_T_mensaje.getText();
              mensaje.replaceAll(mensajeerror[1], "");
              Txt_T_cantidad.setBackground(Color.white);
               eti_T_mensaje.setText(mensaje);
                       }
    }//GEN-LAST:event_Txt_T_cantidadKeyPressed

    private void Txt_T_pinesKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Txt_T_pinesKeyPressed
        String[] mensajeerror=new String[2];
        String caracter = new String();
        String mensaje = new String();
        cadenas cadena = new cadenas();
        boolean error=false;
         t_empaquetado paquete= new t_empaquetado();
         mensajeerror[0] ="ERROR CAMPO NUMERO DE PINES DEBIDO A CARACTER NO NUMERICO";
         mensajeerror[1] ="ERROR CAMPO NUMERO DE PINES DEBIDO A EXCESO CARACTER";
         
      //  caracter= Character.toString(evt.getKeyChar());
        caracter=  Txt_T_pines.getText();
          if (cadena.comparacadena(caracter)== false)
           { Txt_T_pines.setBackground(Color.red);
             if (eti_T_mensaje.getText().length()>0)
              {mensaje = eti_T_mensaje.getText();
               eti_T_mensaje.setText(mensaje + "\n"+ mensajeerror[0]);}
              else { eti_T_mensaje.setText(mensajeerror[0]);} 
                     error=true;}
           
          else {mensaje =eti_T_mensaje.getText();
                   mensaje.replaceAll(mensajeerror[0], "");
                   Txt_T_pines.setBackground(Color.white);
                   eti_T_mensaje.setText(mensaje); 
                    error =false;}
           
                 
          if (caracter.length()> paquete.getTa_empaquetado()[3])
                { if (error==true)
                   {Txt_T_pines.setBackground(Color.red);
                    if (eti_T_mensaje.getText().length()>0)
                      {mensaje = eti_T_mensaje.getText();
                       eti_T_mensaje.setText(mensaje + "\n"+ mensajeerror[1]);}}
                  else{Txt_T_pines.setBackground(Color.red);
                        eti_T_mensaje.setText(mensajeerror[1]);} }
        
          else { if (error==true)
                   {Txt_T_pines.setBackground(Color.red);}
                  else{ Txt_T_pines.setBackground(Color.white);
                          eti_T_mensaje.setText(""); }}
    }//GEN-LAST:event_Txt_T_pinesKeyPressed

    private void b_T_principioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_T_principioActionPerformed
       String nombre_tablas = new String("PRINCIPAL");
      mani_bd dao = new mani_bd();
      t_clase clase= new t_clase();
      t_principal principal = new t_principal();
      t_datasheet datasheet = new t_datasheet();
      t_estados estado = new t_estados();
       t_empaquetado paquete = new t_empaquetado();
      editable_T=false;
      int tam_elemento = clase.getTa_clase().length;
      String [] linea = new String[10];
    
      try {linea = dao.primer_reg_t_principal(nombre_tablas);}
      catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);}
    
      
      principal.setClave(linea[0]);
      principal.setComponente(linea[1]);
      clase.setTipo(linea[2]);
      clase.setSubtipo(linea[3]);
      datasheet.setUrl(linea[4]);
      datasheet.setDatasheet(linea[5]);
       principal.setCantidad(linea[6]);
       estado.setEstado(linea[7]);
      paquete.setEncapsulado(linea[8]);
      paquete.setNumpatillas(linea[9]);
     
      
       com_T_tipo.removeAllItems();
       com_T_subtipo.removeAllItems();
       com_T_estado.removeAllItems();
       com_T_paquete.removeAllItems();
         
       Txt_T_principal.setText( principal.getClave());
        com_T_tipo.addItem(clase.getTipo());
        com_T_subtipo.addItem(clase.getSubtipo());
         com_T_estado.addItem(estado.getEstado());
        com_T_paquete.addItem(paquete.getEncapsulado());
       Txt_T_pines.setText( paquete.getNumpatillas());
        Txt_T_cantidad.setText( principal.getCantidad());
        Txt_T_componente.setText( principal.getComponente());
         Txt_T_datasheet.setText(datasheet.getDatasheet());
        Txt_T_url.setText(datasheet.getUrl());
        
    }//GEN-LAST:event_b_T_principioActionPerformed

    private void b_T_nuevoregistroActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_T_nuevoregistroActionPerformed
        String nombre_tablas = new String("PRINCIPAL");
        String nombre_tablas2 = new String("CLASE");
        String nombre_tablas3 = new String("ESTADO");
        String nombre_tablas4 = new String("EMPAQUETADO");
        
       int clave =0;
       cadenas cadena = new cadenas();
       mani_bd dao = new mani_bd();
       t_clase clase = new t_clase();
       int tamlistpaquete=0;
       int tamlisttipo=0;
       int tamlistsubtipo=0;
        int tamlistestado=0;
       int i=0;
     
       try {
        clave=dao.numeroregistro(nombre_tablas);
        Txt_T_principal.setText(Integer.toString(clave));
        
         
       com_T_tipo.removeAllItems();
       com_T_subtipo.removeAllItems();
       com_T_estado.removeAllItems();
       com_T_paquete.removeAllItems();
      
       Txt_T_componente.setText("");
       Txt_T_datasheet.setText("");
       Txt_T_url.setText("");
       Txt_T_cantidad.setText("");
       Txt_T_pines.setText("");
        
        com_T_paquete.addItem("");
        com_T_estado.addItem("");
        com_TC_tipo.addItem("");
        com_TC_subtipo.addItem("");
        
        
        list_T_paquete=dao.listar_campos(nombre_tablas4,2,clase.getTa_clase()[1]);
        list_T_tipo=dao.listar_campos(nombre_tablas2,3,clase.getTa_clase()[2]);
        list_T_subtipo=dao.listar_campos(nombre_tablas2,4,clase.getTa_clase()[3]);
        list_T_estado=dao.listar_campos(nombre_tablas3,2,clase.getTa_clase()[1]);
        
        list_T_paquete = cadena.quita_repetidos(list_T_paquete);
        list_T_tipo = cadena.quita_repetidos(list_T_tipo);
        list_T_subtipo = cadena.quita_repetidos(list_T_subtipo);
        list_T_estado=cadena.quita_repetidos(list_T_estado);
        
        
         tamlistpaquete=list_T_paquete.size();
         tamlisttipo=list_T_tipo.size();
        tamlistsubtipo=list_T_subtipo.size();
        tamlistestado=list_T_estado.size();
    
        for (i=0;i<tamlisttipo;i++)
         {com_T_tipo.addItem(list_T_tipo.get(i).toString());}
        
        for (i=0;i<tamlistsubtipo;i++)
         {com_T_subtipo.addItem(list_T_subtipo.get(i).toString());}
        
        for (i=0;i<tamlistpaquete;i++)
         {com_T_paquete.addItem(list_T_paquete.get(i).toString());}
         
        for (i=0;i<tamlistestado;i++)
         {com_T_estado.addItem(list_T_estado.get(i).toString());}
            
        editable=true;
        
    } catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
    }
    }//GEN-LAST:event_b_T_nuevoregistroActionPerformed

    private void b_TD_borrarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_TD_borrarActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_b_TD_borrarActionPerformed

    private void b_T_BajaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_T_BajaActionPerformed
       String nombre_tablas = new String("PRINCIPAL");
       mani_bd dao = new mani_bd();
       t_clase clase= new t_clase();
      t_principal principal = new t_principal();
      t_datasheet datasheet = new t_datasheet();
      t_estados estado = new t_estados();
       t_empaquetado paquete = new t_empaquetado();
        int tam_elemento = clase.getTa_clase().length;
      String [] linea = new String[10];
      try {
        dao.bajabd_principal(nombre_tablas, Txt_T_principal.getText(),"1");
        dao.actualizaindices_principal(nombre_tablas,Txt_T_principal.getText() );
         linea = dao.primer_reg_t_principal(nombre_tablas);
        
       principal.setClave(linea[0]);
      principal.setComponente(linea[1]);
      clase.setTipo(linea[2]);
      clase.setSubtipo(linea[3]);
      datasheet.setUrl(linea[4]);
      datasheet.setDatasheet(linea[5]);
       principal.setCantidad(linea[6]);
       estado.setEstado(linea[7]);
      paquete.setEncapsulado(linea[8]);
      paquete.setNumpatillas(linea[9]);
     
      
       com_T_tipo.removeAllItems();
       com_T_subtipo.removeAllItems();
       com_T_estado.removeAllItems();
       com_T_paquete.removeAllItems();
         
       Txt_T_principal.setText( principal.getClave());
        com_T_tipo.addItem(clase.getTipo());
        com_T_subtipo.addItem(clase.getSubtipo());
         com_T_estado.addItem(estado.getEstado());
        com_T_paquete.addItem(paquete.getEncapsulado());
       Txt_T_pines.setText( paquete.getNumpatillas());
        Txt_T_cantidad.setText( principal.getCantidad());
        Txt_T_componente.setText( principal.getComponente());
         Txt_T_datasheet.setText(datasheet.getDatasheet());
        Txt_T_url.setText(datasheet.getUrl()); 
           
    } catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
    }
        
    }//GEN-LAST:event_b_T_BajaActionPerformed

    private void b_T_modificacionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_b_T_modificacionActionPerformed
        String [] linea = new String[6];
       String [] tablas = new String[4];
      
       mani_bd dao = new mani_bd();
       int validacion=0;
       t_clase clase= new t_clase();
      t_principal principal = new t_principal();
      t_datasheet datasheet = new t_datasheet();
      t_estados estado = new t_estados();
       t_empaquetado paquete = new t_empaquetado();
       cadenas cadena = new cadenas();
       String mensaje = "";
    //  String malo = new String(com_TC_clase.getItemAt(1));
            
         //com_TC_clase.getSelectedItem().toString().;
     
       
       if ((Txt_T_componente.getBackground()!=Color.red)&&(Txt_T_componente.getText().length()>0))
           {linea[0]=cadena.aster_izq(Txt_T_componente.getText(),principal.getTa_principal()[1]);
            // validacion=false;
           }
       else{validacion++;}
       
        if ((Txt_T_cantidad.getBackground()!=Color.red)&&(Txt_T_cantidad.getText().length()>0))
           {linea[1]=cadena.cero_izq(Txt_T_cantidad.getText(),principal.getTa_principal()[4]);
                
           }
       else{validacion++;}
       
       
       if ((com_T_tipo.getBackground()!=Color.red)&&(com_T_tipo.getSelectedItem().toString().length()>0))
           {linea[2]="TIPO='"+  cadena.aster_izq(com_T_tipo.getSelectedItem().toString(),clase.getTa_clase()[2])+"'";
              tablas[0]= "CLASE";
           }
       else{validacion++;}
       
         if ((com_T_subtipo.getBackground()!=Color.red)&&(com_T_subtipo.getSelectedItem().toString().length()>0))
           {linea[2]=linea[2]+" AND SUBTIPO='"+ cadena.aster_izq(com_T_subtipo.getSelectedItem().toString(),clase.getTa_clase()[3])+"'";}
        else{validacion++;}
        
           if ((com_T_estado.getBackground()!=Color.red)&&(com_T_estado.getSelectedItem().toString().length()>0))
           {linea[3]="DESESTADO='" + cadena.aster_izq(com_T_estado.getSelectedItem().toString(),estado.getTa_estados()[1])+"'";
             tablas[1]= "ESTADO";
           }
       else{validacion++;}
         
         
         
         
          if ((com_T_paquete.getBackground()!=Color.red)&&(com_T_paquete.getSelectedItem().toString().length()>0))
           {linea[4]="ENCAPSULADO='"+ cadena.aster_izq(com_T_paquete.getSelectedItem().toString(),paquete.getTa_empaquetado()[1])+"'";
            tablas[2]= "EMPAQUETADO";
           }
        else{validacion++;}
              
       
        if ((Txt_T_pines.getBackground()!=Color.red)&&(Txt_T_pines.getText().length()>0))
           {linea[4]=linea[4] +"AND NUMPATILLAS='" + cadena.cero_izq(Txt_T_pines.getText(),paquete.getTa_empaquetado()[3])+"'";
              tablas[2]= "EMPAQUETADO";
           }
        else{validacion++;}
        if ((Txt_T_url.getBackground()!=Color.red)&&(Txt_T_url.getText().length()>0))
           {linea[5]="URL='"+cadena.aster_izq(Txt_T_url.getText(),datasheet.getTa_datasheet()[2])+"'";
             tablas[3]= "DATASHEET";       
           }
         else{validacion++;}
        
        if ((Txt_T_datasheet.getBackground()!=Color.red)&&(Txt_T_datasheet.getText().length()>0))
         {linea[5]= linea[5]+ " AND DATASHEET='"  + cadena.aster_izq(Txt_T_datasheet.getText(),datasheet.getTa_datasheet()[3])+"'";
           }
         else{validacion++;}
        
        if (validacion ==0)
       { eti_TC_mensaje.setText("");
        try {
         mensaje= dao.modificacionbd_principal(linea,tablas,Txt_T_principal.getText());
         eti_TC_mensaje.setText(mensaje);
        editable=false;
          } catch (SQLException ex) {
        Logger.getLogger(CRUD.class.getName()).log(Level.SEVERE, null, ex);
             }}
       else 
       { eti_TC_mensaje.setText("Hay campos que dan error");}
       
       
       
       
       
    }//GEN-LAST:event_b_T_modificacionActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(CRUD.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(CRUD.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(CRUD.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(CRUD.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new CRUD().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel CRUD_T_clase;
    private javax.swing.JPanel CRUD_T_datasheet;
    public javax.swing.JPanel CRUD_T_empaquetado;
    private javax.swing.JPanel CRUD_T_estado;
    private javax.swing.JPanel CRUD_T_principal;
    private javax.swing.JLabel Eti_TC_clase;
    private javax.swing.JLabel Eti_TC_principal;
    private javax.swing.JLabel Eti_TC_subtipo;
    private javax.swing.JLabel Eti_TC_tipo;
    private javax.swing.JLabel Eti_TD_descripcion;
    private javax.swing.JLabel Eti_TD_encapsulado3;
    private javax.swing.JLabel Eti_TD_principal;
    private javax.swing.JLabel Eti_TD_url;
    private javax.swing.JLabel Eti_TE_estado;
    private javax.swing.JLabel Eti_TE_principal;
    private javax.swing.JLabel Eti_TP_descripcion;
    private javax.swing.JLabel Eti_TP_descripcion1;
    private javax.swing.JLabel Eti_TP_encapsulado2;
    private javax.swing.JLabel Eti_TP_npatillas1;
    private javax.swing.JLabel Eti_TP_principal1;
    private javax.swing.JLabel Eti_T_componente;
    private javax.swing.JLabel Eti_T_datasheet;
    private javax.swing.JLabel Eti_T_estado;
    private javax.swing.JLabel Eti_T_estado1;
    private javax.swing.JLabel Eti_T_paquete1;
    private javax.swing.JLabel Eti_T_pines;
    private javax.swing.JLabel Eti_T_principal;
    private javax.swing.JLabel Eti_T_subtipo;
    private javax.swing.JLabel Eti_T_tipo;
    private javax.swing.JLabel Eti_T_url;
    private javax.swing.JMenuBar MenuCRUD;
    private javax.swing.JTabbedPane Panel_tablas;
    private javax.swing.JTextField Txt_TC_principal;
    private javax.swing.JTextField Txt_TD_Datasheet;
    private javax.swing.JTextField Txt_TD_descripcion;
    private javax.swing.JTextField Txt_TD_principal;
    private javax.swing.JTextField Txt_TD_url;
    private javax.swing.JTextField Txt_TE_estado;
    private javax.swing.JTextField Txt_TE_principal;
    private javax.swing.JTextField Txt_TP_descripcion1;
    private javax.swing.JTextField Txt_TP_encapsulado1;
    private javax.swing.JTextField Txt_TP_npatillas1;
    private javax.swing.JTextField Txt_TP_principal;
    private javax.swing.JTextField Txt_TP_url;
    private javax.swing.JTextField Txt_T_cantidad;
    private javax.swing.JTextField Txt_T_componente;
    private javax.swing.JTextField Txt_T_datasheet;
    private javax.swing.JTextField Txt_T_pines;
    private javax.swing.JTextField Txt_T_principal;
    private javax.swing.JTextField Txt_T_url;
    private javax.swing.JButton b_TC_Baja;
    private javax.swing.JButton b_TC_adelante;
    private javax.swing.JButton b_TC_alta;
    private javax.swing.JButton b_TC_atras;
    private javax.swing.JButton b_TC_final;
    private javax.swing.JButton b_TC_modificacion;
    private javax.swing.JButton b_TC_modificacion1;
    private javax.swing.JButton b_TC_nuevoregistro;
    private javax.swing.JButton b_TC_principio;
    private javax.swing.JButton b_TD_adelante;
    private javax.swing.JButton b_TD_alta;
    private javax.swing.JButton b_TD_atras;
    private javax.swing.JButton b_TD_baja;
    private javax.swing.JButton b_TD_borrar;
    private javax.swing.JButton b_TD_buscar;
    private javax.swing.JButton b_TD_final;
    private javax.swing.JButton b_TD_modificar;
    private javax.swing.JButton b_TD_nuevoregistro;
    private javax.swing.JButton b_TD_principio;
    private javax.swing.JButton b_TE_adelante;
    private javax.swing.JButton b_TE_alta;
    private javax.swing.JButton b_TE_atras;
    private javax.swing.JButton b_TE_baja;
    private javax.swing.JButton b_TE_borrar;
    private javax.swing.JButton b_TE_final;
    private javax.swing.JButton b_TE_modificar;
    private javax.swing.JButton b_TE_principio;
    private javax.swing.JButton b_TP_adelante;
    private javax.swing.JButton b_TP_alta;
    private javax.swing.JButton b_TP_atras;
    private javax.swing.JButton b_TP_baja;
    private javax.swing.JButton b_TP_borrar;
    private javax.swing.JButton b_TP_confirmar1;
    private javax.swing.JButton b_TP_final;
    private javax.swing.JButton b_TP_modificar;
    private javax.swing.JButton b_TP_nuevoregistro;
    private javax.swing.JButton b_TP_principio;
    private javax.swing.JButton b_T_Baja;
    private javax.swing.JButton b_T_adelante;
    private javax.swing.JButton b_T_alta;
    private javax.swing.JButton b_T_atras;
    private javax.swing.JButton b_T_buscar;
    private javax.swing.JButton b_T_final;
    private javax.swing.JButton b_T_modificacion;
    private javax.swing.JButton b_T_modificacion2;
    private javax.swing.JButton b_T_nuevoregistro;
    private javax.swing.JButton b_T_principio;
    private javax.swing.JButton b_llenartabla;
    private javax.swing.JButton b_llenartabla1;
    private javax.swing.JComboBox<String> com_TC_clase;
    private javax.swing.JComboBox<String> com_TC_subtipo;
    private javax.swing.JComboBox<String> com_TC_tipo;
    private javax.swing.JComboBox<String> com_T_estado;
    private javax.swing.JComboBox<String> com_T_paquete;
    private javax.swing.JComboBox<String> com_T_subtipo;
    private javax.swing.JComboBox<String> com_T_tipo;
    private javax.swing.JLabel eti_TC_mensaje;
    private javax.swing.JLabel eti_TC_mensaje1;
    private javax.swing.JLabel eti_TD_mensaje;
    private javax.swing.JLabel eti_TE_mensaje;
    private javax.swing.JLabel eti_TP_mensaje;
    private javax.swing.JLabel eti_T_mensaje;
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JMenu jMenu1;
    private javax.swing.JMenu jMenu2;
    private javax.swing.JPanel jPanel2;
    public javax.swing.JTextField txt_directorio;
    public javax.swing.JTextField txt_tabla;
    // End of variables declaration//GEN-END:variables
}
